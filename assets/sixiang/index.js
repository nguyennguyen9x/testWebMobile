window.__require=function e(t,i,n){function a(o,l){if(!i[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var r="function"==typeof __require&&__require;if(!l&&r)return r(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+o+"'")}o=c}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){return a(t[o][1][e]||e)},d,d.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof __require&&__require,o=0;o<n.length;o++)a(n[o]);return a}({SixiangAnimWin:[function(e,t,i){"use strict";cc._RF.push(t,"3b39cVJ9bpOjoW/pFRxEr5d","SixiangAnimWin");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/common/Utils"),{ccclass:s,property:o}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.lbWinDragonPearl=null,this.animWin=null,this.anilight=null,this.aniWinRapidPay=null,this.aniWinDragonPearl=null}setInfoResult(e,t){5==t?(this.animWin.skeletonData=this.aniWinRapidPay,this.lbWinDragonPearl.node.y=-110):(this.animWin.skeletonData=this.aniWinDragonPearl,this.lbWinDragonPearl.node.y=-45),this.anilight.setAnimation(0,"animation",!0),this.animWin.setAnimation(0,"cam",!1),this.lbWinDragonPearl.string=a.default.formatNumber(e)}};n([o(cc.Label)],l.prototype,"lbWinDragonPearl",void 0),n([o(sp.Skeleton)],l.prototype,"animWin",void 0),n([o(sp.Skeleton)],l.prototype,"anilight",void 0),n([o(sp.SkeletonData)],l.prototype,"aniWinRapidPay",void 0),n([o(sp.SkeletonData)],l.prototype,"aniWinDragonPearl",void 0),l=n([s],l),i.default=l,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0}],SixiangBuyChipDialog:[function(e,t,i){"use strict";cc._RF.push(t,"605d5XrjMZLZocrhgP3drTK","SixiangBuyChipDialog");var n,a=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const s=e("./SixiangConstants"),o=e("../../lobby/src/common/Utils"),l=e("../../lobby/src/common/GlobalApp"),c=e("../../lobby/src/language/LanguageController"),r=e("../../lobby/src/common/ConfigClient"),d=e("../../lobby/src/common/BaseDialog"),h=e("./SixiangController"),{ccclass:m,property:u}=cc._decorator;let p=n=class extends d.default{constructor(){super(...arguments),this.sprBall=null,this.listSprBalls=[],this.lbPrices=null,this.idMiniGame=0,this.idxMiniGame=0,this.agPlayer=0,this.agPrice=0,this.sixiangSymbolSixangbonus={}}static getInstance(){return this.instance}static show(e,t,i,a,s){null==this.instance||null==this.instance.node?l.default.getInstance().loadPrefabByBundle(r.default.Bundle.BUNDLE_NAME.SIXIANG,"res/prefabs/SixiangBuyChipDialog",(o,c)=>{if(null!=o)return void l.default.getInstance().alertDialog.showMessage(o);let r=cc.instantiate(c);r.parent=e,this.instance=r.getComponent(n),this.instance.node.zIndex=1e3,this.instance.init(t,i,a,s),this.instance.show()}):(this.instance.node.zIndex=1e3,this.instance.init(t,i,a,s),this.instance.show())}init(e,t,i,n){this.sixiangSymbolSixangbonus={0:s.SiXiangGame.DRAGON_PEARL,1:s.SiXiangGame.GOLDPICK,2:s.SiXiangGame.RAPIDPAY,3:s.SiXiangGame.LUCKDRAW},this.idMiniGame=this.sixiangSymbolSixangbonus[e],this.idxMiniGame=e,this.sprBall.spriteFrame=this.listSprBalls[e],this.agPlayer=n,this.agPrice=i,this.lbPrices.string="<color=#FFFFFF> \u1794\u1784\u17cb </c><color=#FCA100>"+o.default.formatNumber(this.agPrice)+"</color> Chip to get this gem immediately!"}actionConfirm(){Number(this.agPlayer)<Number(this.agPrice)?l.default.getInstance().alertDialog.showMessage(c.default.getInstance().getString("txt_not_enough_money_gl")):(h.default.getInstance().handleBuyBonusGame(this.idMiniGame,this.idxMiniGame),this.close())}};p.instance=null,a([u(cc.Sprite)],p.prototype,"sprBall",void 0),a([u([cc.SpriteFrame])],p.prototype,"listSprBalls",void 0),a([u(cc.RichText)],p.prototype,"lbPrices",void 0),p=n=a([m],p),i.default=p,cc._RF.pop()},{"../../lobby/src/common/BaseDialog":void 0,"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/common/Utils":void 0,"../../lobby/src/language/LanguageController":void 0,"./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController"}],SixiangConstants:[function(e,t,i){"use strict";cc._RF.push(t,"1aee9dE8odCvJ9e0LTu/BcY","SixiangConstants"),Object.defineProperty(i,"__esModule",{value:!0}),i.TimeBigWin=i.SiXiangJackpot=i.SiXiangSymbolGoldPick=i.SiXiangSymbolRapidPay=i.SiXiangSymbolSixAngBonus=i.SiXiangSymbolBonus=i.SiXiangSymbolDragonPearl=i.SiXiangSymbolLuckyDraw=i.SiXiangGame=void 0,function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.NORMAL=1]="NORMAL",e[e.BONUS=2]="BONUS",e[e.DRAGON_PEARL=3]="DRAGON_PEARL",e[e.LUCKDRAW=4]="LUCKDRAW",e[e.GOLDPICK=5]="GOLDPICK",e[e.RAPIDPAY=6]="RAPIDPAY",e[e.SIXANGBONUS=7]="SIXANGBONUS",e[e.SIXANGBONUS_DRAGON_PEARL=8]="SIXANGBONUS_DRAGON_PEARL",e[e.SIXANGBONUS_LUCKDRAW=9]="SIXANGBONUS_LUCKDRAW",e[e.SIXANGBONUS_GOLDPICK=10]="SIXANGBONUS_GOLDPICK",e[e.SIXANGBONUS_RAPIDPAY=11]="SIXANGBONUS_RAPIDPAY"}(i.SiXiangGame||(i.SiXiangGame={})),function(e){e[e.MINOR=1536]="MINOR",e[e.MAJOR=1537]="MAJOR",e[e.MEGA=1538]="MEGA",e[e.GRAND=1539]="GRAND",e[e.GOLD_1=1540]="GOLD_1",e[e.GOLD_2=1541]="GOLD_2",e[e.GOLD_3=1542]="GOLD_3"}(i.SiXiangSymbolLuckyDraw||(i.SiXiangSymbolLuckyDraw={})),function(e){e[e.GEM_RANDOM1=1281]="GEM_RANDOM1",e[e.GEM_RANDOM2=1282]="GEM_RANDOM2",e[e.GEM_RANDOM3=1283]="GEM_RANDOM3",e[e.GEM_RANDOM4=1284]="GEM_RANDOM4",e[e.GEM_RANDOM5=1285]="GEM_RANDOM5",e[e.EYE_BIRD=1296]="EYE_BIRD",e[e.EYE_TIGER=1297]="EYE_TIGER",e[e.EYE_WARRIOR=1298]="EYE_WARRIOR",e[e.EYE_DRAGON=1299]="EYE_DRAGON",e[e.JP_MINOR=1300]="JP_MINOR",e[e.JP_MAJOR=1301]="JP_MAJOR",e[e.JP_MEGA=1302]="JP_MEGA",e[e.JP_GRAND=1303]="JP_GRAND"}(i.SiXiangSymbolDragonPearl||(i.SiXiangSymbolDragonPearl={})),function(e){e[e.DRAGONBALL=1025]="DRAGONBALL",e[e.LUCKYDRAW=1026]="LUCKYDRAW",e[e.GOLDPICK=1027]="GOLDPICK",e[e.RAPIDPAY=1028]="RAPIDPAY",e[e.GOLDX10=1029]="GOLDX10",e[e.GOLDX20=1030]="GOLDX20",e[e.GOLDX30=1031]="GOLDX30",e[e.GOLDX50=1032]="GOLDX50"}(i.SiXiangSymbolBonus||(i.SiXiangSymbolBonus={})),function(e){e[e.DRAGONPEARL_GAME=2305]="DRAGONPEARL_GAME",e[e.LUCKYDRAW_GAME=2306]="LUCKYDRAW_GAME",e[e.GOLDPICK_GAME=2307]="GOLDPICK_GAME",e[e.RAPIDPAY_GAME=2308]="RAPIDPAY_GAME"}(i.SiXiangSymbolSixAngBonus||(i.SiXiangSymbolSixAngBonus={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.END=2048]="END",e[e.X2=2049]="X2",e[e.X3=2050]="X3",e[e.X4=2051]="X4",e[e.LUCKYBOX=2052]="LUCKYBOX"}(i.SiXiangSymbolRapidPay||(i.SiXiangSymbolRapidPay={})),function(e){e[e.TRYAGAIN=1792]="TRYAGAIN",e[e.GOLD1=1793]="GOLD1",e[e.GOLD2=1794]="GOLD2",e[e.GOLD3=1795]="GOLD3",e[e.GOLD4=1796]="GOLD4",e[e.GOLD5=1797]="GOLD5",e[e.JP_MINOR=1798]="JP_MINOR",e[e.JP_MAJOR=1799]="JP_MAJOR",e[e.JP_MEGA=1800]="JP_MEGA"}(i.SiXiangSymbolGoldPick||(i.SiXiangSymbolGoldPick={})),function(e){e[e.MINOR=10]="MINOR",e[e.MAJOR=20]="MAJOR",e[e.MEGA=30]="MEGA",e[e.GRAND=150]="GRAND"}(i.SiXiangJackpot||(i.SiXiangJackpot={})),function(e){e[e.MEGA_WIN=9]="MEGA_WIN",e[e.HUGE_WIN=7]="HUGE_WIN",e[e.BIG_WIN=7]="BIG_WIN",e[e.NICE_WIN=6]="NICE_WIN"}(i.TimeBigWin||(i.TimeBigWin={})),cc._RF.pop()},{}],SixiangController:[function(e,t,i){"use strict";cc._RF.push(t,"55e71OViW9DMKEdeMQ2bhfo","SixiangController");var n,a=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const s=cc.v2(162,165),o=e("../../lobby/src/common/Constants"),l=e("../../lobby/src/common/Utils"),c=e("../../lobby/src/language/LanguageController"),r=e("../../lobby/src/dialogs/banner/BannerDialog"),d=e("./SixiangConstants"),h=e("../../lobby/src/common/GlobalApp"),m=e("../../lobby/src/dialogs/option/OptionDialog"),u=e("../../lobby/src/chat/ChatPresenter"),p=e("./SixiangRuleDialog"),g=e("./SixiangBuyChipDialog"),S=e("./SixiangPresenter"),f=e("./SixiangNetworkTransport"),b=e("./SixiangScatterSpin"),A=e("./SixiangUtils"),y=e("./SixiangItem"),C=e("./SixiangPickGold"),R=e("./SixiangDragonPearl"),D=e("./SixiangLuckyDraw"),G=e("./SixiangRapidPay"),{ccclass:k,property:I}=cc._decorator;let P=n=class extends cc.Component{constructor(){super(...arguments),this.colums=null,this.nodeTop=null,this.nodeMiddle=null,this.itemPrefab=null,this.lbCurrentBet=null,this.sprTypeCurrentBet=null,this.lbTitleWin=null,this.sprTitleWin=null,this.lbAgUser=null,this.lbChipWin=null,this.lb_Result=null,this.lb_info=null,this.aniChipWin=null,this.aniGameName=null,this.btn_Spin=null,this.listItemMiniResult=[],this.itemMiniResult=null,this.lbMinor=null,this.lbMajor=null,this.lbMega=null,this.lbGrand=null,this.scatterSpin=null,this.nodeGoldPick=null,this.nodeDragonPeals=null,this.nodeLuckyDraw=null,this.nodeRapidPay=null,this.nodeBlack=null,this.nodeAnimWin=null,this.nodeBlackTotalWin=null,this.animRong=null,this.nodeDragonBalls=null,this.nodePopupBonusGame=null,this.nodeBuyBalls=null,this.listSprTypeCurrentBet=[],this.listSprTitleWin=[],this.animDatas=[],this.speedSpin=null,this.luckyDrawWin=null,this.fontGo3v2=null,this.screenBonus=null,this.miniGameAnims=[],this.btnSkipTotalWin=null,this.bigwin_amin=null,this.number_win_font=null,this.timeShowAnimBigWin=0}static getInstance(){return this.instance}onLoad(){n.instance=this,f.default.subscribe(),this.gameType=d.SiXiangGame.NORMAL,this.winAmount=0,this.numberOfDragonPearlSpins=0,this.listColor=["#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE","#920E48","#F277E2","#BC8B15","#AC6456","#E17512","#E8C500","#F0E915","#FD93A1","#C735D4","#FF0C04","#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE","#920E48","#F277E2","#BC8B15","#AC6456","#E17512","#E8C500","#F0E915","#FD93A1","#C735D4","#FF0C04","#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE","#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE"],this.payLine=[[1,1,1,1,1],[0,0,0,0,0],[2,2,2,2,2],[2,1,0,1,2],[0,1,2,1,0],[1,2,1,0,1],[1,2,1,2,1],[0,1,0,1,2],[2,1,2,1,0],[2,1,0,1,0],[0,1,2,1,2],[1,0,1,2,1],[2,1,2,1,2],[1,0,1,0,1],[0,1,0,1,0],[1,1,2,1,1],[0,0,1,0,0],[2,2,1,2,2],[1,1,0,1,1],[0,0,2,0,0],[2,2,0,2,2],[1,1,1,2,1],[0,0,0,1,2],[2,2,2,1,0],[2,1,1,1,0]],this.sixiang_symbol_index={1:0,2:1,4:2,8:3,16:4,32:5,64:6,256:7,128:8,512:10,65535:9},this.sixiang_symbol_sixangbonus={0:d.SiXiangSymbolSixAngBonus.DRAGONPEARL_GAME,1:d.SiXiangSymbolSixAngBonus.GOLDPICK_GAME,2:d.SiXiangSymbolSixAngBonus.RAPIDPAY_GAME,3:d.SiXiangSymbolSixAngBonus.LUCKYDRAW_GAME},this.betIndex=0,this.isCheckReceivedData=!1,this.stopCol=!1,this.isHoldSpin=!1,this.isFreeSpin=!1,this.isAutoSpin=!1,this.isFinishAction=!0,this.timeHoldSpin=0,this.listWinLineNode=[],this.listScatter=[],this.listLineWinPos=[],this.listItemLineWin=[],this.listLineRect=[],this.listColumnContainsWild=[],this.listWild=[],this.winningLine=[],this.clickSpinCount=0,this.isCheckTwoScatter=!1,this.limitAutoSpin=0,this.totalWinMiniGame=0,this.isSelectBonusGame=!1,this.isBonusGame=!1,this.isCheckingShowOneLine=!1,this.bonusGameMultiplier=1,this.nodePopupBonusGame.zIndex=500,this.callbackForceClose=null,this.clickSkip=null}update(e){if(this.isHoldSpin&&(this.timeHoldSpin+=e,this.timeHoldSpin>=1&&!this.isAutoSpin&&this.gameType==d.SiXiangGame.NORMAL)){this.isAutoSpin=!this.isAutoSpin,this.isHoldSpin=!1,this.timeHoldSpin=0;let e=this.btn_Spin.node.getChildByName("boxAutoSpin");cc.tween(e).to(.5,{y:160}).start()}}start(){this.setMatchInfo(),this.lbLimit=this.btn_Spin.node.getChildByName("lbLimitAuto").getComponent(cc.Label),this.sprLimit=this.btn_Spin.node.getChildByName("sprLimited").getComponent(cc.Sprite);for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e],i=29+6*e;for(let e=0;e<i;e++){let i=cc.instantiate(this.itemPrefab);i.setPosition(cc.v2(0,165*e-165)),i.parent=t;let n=Math.floor(10*Math.random());i.getComponent(y.default).setSpriteFrame(n),i.getComponent(y.default).setIndexRow(e)}}this.animBtnSpin=this.btn_Spin.node.getChildByName("animSpin").getComponent(sp.Skeleton),this.btn_Spin.node.on("touchstart",e=>{this.btn_Spin.node.getBoundingBoxToWorld().contains(e.getLocation())&&(this.timeHoldSpin=0,this.isHoldSpin=!0)}),this.btn_Spin.node.on("touchend",e=>{this.isHoldSpin&&(this.btn_Spin.node.getBoundingBoxToWorld().contains(e.getLocation())&&(this.isHoldSpin=!1,this.timeHoldSpin<1&&this.spin()),this.timeHoldSpin=0)}),this.aniChipWin.node.zIndex=500,this.nodeBlackTotalWin.setScale(0),this.nodeBlackTotalWin.removeAllChildren(),r.default.show(o.Game.Enum.SIXIANG)}spin(){this.playSoundEff("clickspin");let e=this.btn_Spin.node.getChildByName("boxAutoSpin");if(cc.tween(e).to(.5,{y:-250}).start(),this.gameType===d.SiXiangGame.NORMAL){if(this.clickSpinCount++,0==this.limitAutoSpin&&this.isAutoSpin){let e=this.btn_Spin.node.getChildByName("boxAutoSpin");cc.tween(e).to(.5,{y:-250}).start()}if(this.clickSpinCount>1||0==this.limitAutoSpin&&this.isAutoSpin)return this.isAutoSpin=!1,this.setStateSpinBtn(),this.clickSpinCount=0,this.limitAutoSpin=0,this.lbLimit.node.active=!1,void(this.sprLimit.node.active=!1);if(this.isCheckingShowOneLine&&(this.spinNormalData.isBonusMiniGame||this.spinNormalData.isGrandJackpot||(cc.Tween.stopAllByTarget(this.node),this.resetForNextSpin(),this.isFinishAction=!0,this.isCheckingShowOneLine=!1)),this.agPlayer<Number(this.infoData.betLevels[this.betIndex]))return this.lb_info.string=c.default.getInstance().getString("not_enought_gold"),h.default.getInstance().alertDialog.showMessage(c.default.getInstance().getString("txt_not_enough_money_gl")),this.isAutoSpin=!1,this.setStateSpinBtn(),this.resetForNextSpin(),this.clickSpinCount=0,this.lbLimit.node.active=!1,void(this.sprLimit.node.active=!1)}if(this.isFinishAction){switch(this.isFinishAction=!1,cc.Tween.stopAllByTarget(this.node),this.gameType==d.SiXiangGame.NORMAL&&(this.resetForNextSpin(),this.setStateSpinBtn()),this.gameType){case d.SiXiangGame.NORMAL:S.default.sendActionSpin(this.infoData.betLevels[this.betIndex]),this.limitAutoSpin>0?(this.limitAutoSpin--,this.lbLimit.string=""+this.limitAutoSpin):0==this.limitAutoSpin&&(this.lbLimit.node.active=!1),this.lb_info.string=c.default.getInstance().getString("txt_playing_lines").replace("%d",25..toString());break;case d.SiXiangGame.DRAGON_PEARL:S.default.sendActionSpin(this.infoData.betLevels[this.betIndex]);break;case d.SiXiangGame.LUCKDRAW:S.default.sendActionSpinNoBody(d.SiXiangGame.LUCKDRAW),this.isFinishAction=!0}this.lb_info.node.active=!0,this.nodeBuyBalls.active=!1,this.gameType==d.SiXiangGame.NORMAL||this.gameType==d.SiXiangGame.DRAGON_PEARL||(this.sprTitleWin.spriteFrame=this.listSprTitleWin[1])}}setMatchInfo(){u.default.getInstance().joinChatRoom(h.default.getInstance().matchInfo.match_id,this)}setStateSpinBtn(e=null){let t;switch(t=this.isAutoSpin?"autoSpin":"spinOff",t=this.isFreeSpin?"freespinOff":t,null!==e&&(t=e),t){case"spinOn":this.animBtnSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animBtnSpin.setAnimation(0,"spin",!0);break;case"spinOff":this.animBtnSpin.node.active=!0,this.animBtnSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animBtnSpin.setAnimation(0,"spin",!0);break;case"freespinOn":case"freespinOff":this.animBtnSpin.node.active=!0,this.animBtnSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animBtnSpin.setAnimation(0,"freespin",!0);break;case"autoSpin":this.animBtnSpin.node.active=!0,-999==this.limitAutoSpin?(this.lbLimit.node.active=!1,this.sprLimit.node.active=!0):(this.sprLimit.node.active=!1,this.lbLimit.node.active=!0),this.animBtnSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animBtnSpin.setAnimation(0,"stop_daylen",!0)}}onClickBack(){m.default.show(this,m.DialogPosition.LEFT)}getInfo(e){this.scatterSpin.node.active=!1,this.nodeBuyBalls.children.forEach(e=>{cc.tween(e).to(.2,{x:200}).start()}),this.lbCurrentBet.string=l.default.formatNumberToString(e.bet),e.bet==e.betLevels[e.betLevels.length-1]&&(this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[1]),this.infoData=e,this.gameType=e.gameType,this.numberOfDragonPearlSpins=e.numSpinLeft,this.rapidPayReward=e.matrix,this.agPlayer=e.userAmount,this.winAmount=e.winAmount,this.isBonusGame=e.isBonusGame,this.bonusGameMultiplier=e.bonusGameMultiplier,this.updateJackpot(e.bet);for(let t=0;t<e.betLevels.length;t++)if(Number(e.betLevels[t])===Number(e.chipsMcb)){this.betIndex=t;break}switch(e.gameType!==d.SiXiangGame.NORMAL?(this.sprTitleWin.spriteFrame=this.listSprTitleWin[1],this.nodeBuyBalls.active=!1,this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"sixiang",!1)):(this.lbChipWin.string=l.default.formatNumberToString(e.winAmount),this.lbAgUser.string=l.default.formatNumberToString(e.userAmount)),this.handleGetBonusGames(e),e.gameType){case d.SiXiangGame.NORMAL:break;case d.SiXiangGame.DRAGON_PEARL:case d.SiXiangGame.SIXANGBONUS_DRAGON_PEARL:this.setMiniGameDragonPearl(e,e.winAmount,!1);break;case d.SiXiangGame.LUCKDRAW:case d.SiXiangGame.SIXANGBONUS_LUCKDRAW:this.setMiniGameLuckyDraw(e);break;case d.SiXiangGame.GOLDPICK:case d.SiXiangGame.SIXANGBONUS_GOLDPICK:this.setMiniGameGoldPick(e);break;case d.SiXiangGame.RAPIDPAY:case d.SiXiangGame.SIXANGBONUS_RAPIDPAY:this.setMiniGameRapidPay(e);break;case d.SiXiangGame.SIXANGBONUS:this.setPopupBonusGame()}}updateDesk(e){if(e.currentSixiangGame<=d.SiXiangGame.SIXANGBONUS&&e.nextSixiangGame>d.SiXiangGame.SIXANGBONUS)return void S.default.getMatchResult();if(e.currentSixiangGame===d.SiXiangGame.BONUS)return void this.scatterSpin.handleData(e);if(this.getInfo(Object.assign({bet:Number(e.chipsMcb),betLevels:e.betLevels,gameType:e.currentSixiangGame,numberOfDragonPearlSpins:e.numSpinleft,matrix:e.matrix,userAmount:e.gameReward.balanceChipsWalletAfter,winAmount:e.gameReward.totalChipsWinByGame,bonusGameMultiplier:e.currentSixiangGame>d.SiXiangGame.SIXANGBONUS?4:1,isBonusGame:e.currentSixiangGame>d.SiXiangGame.SIXANGBONUS},e)),e.currentSixiangGame!==d.SiXiangGame.NORMAL)return;let t=[];for(let i=0;i<e.matrix.cols;i++)for(let n=0;n<e.matrix.lists.length;n++)n%e.matrix.cols===i&&t.push(e.matrix.lists[n]);e.isFinishGame&&this.handleNormalSpin(e)}handleNormalSpin(e){let t=[];for(let a=0;a<e.matrix.cols;a++)for(let i=0;i<e.matrix.lists.length;i++)i%e.matrix.cols===a&&t.push(e.matrix.lists[i]);let i=Object.assign(Object.assign({},e),{winAmount:e.gameReward.totalChipsWinByGame,userAmount:e.gameReward.balanceChipsWalletAfter,isGrandJackpot:!1,isBonusMiniGame:e.nextSixiangGame!==d.SiXiangGame.NORMAL,payLines:e.paylines.map(t=>({winAmount:Number(t.chips),line:t.indices.map(t=>this.sixiang_symbol_index[e.spreadMatrix.lists[t]]),lineNumber:t.id-1,symbol:t.symbol,numberOfSymbols:t.numOccur})),reels:t.map(e=>this.sixiang_symbol_index[e]).reduce((e,t,i)=>{const n=Math.floor(i/3);return e[n]||(e[n]=[]),e[n].push(t),e},[])});this.spinNormalData=i,this.isCheckReceivedData=!0,this.reels=[...i.reels],this.agPlayer=i.userAmount,this.totalWin=Number(i.winAmount)+Number(this.infoData.betLevels[this.betIndex]);let n=0;for(let a=0;a<i.reels.length-1;a++)for(let e=0;e<i.reels[a].length;e++)if(10==i.reels[a][e]){n++;break}this.isCheckTwoScatter=n>=2;for(let a=0;a<this.colums.childrenCount;a++){let e=this.colums.children[a];for(let t=e.childrenCount-1;t>=e.childrenCount-3;t--){let i=e.children[t].getComponent(y.default);i.setSpriteFrame(this.reels[a][e.childrenCount-1-t]),i.setIndexRow(e.childrenCount-1-t),i.setIndexCol(a)}}this.playSoundEff("wheelspin");for(let a=0;a<this.colums.childrenCount;a++){let e=this.colums.children[a];for(let t=0;t<e.childrenCount;t++){let n=e.children[t].getComponent(y.default);n.node.active=!0,cc.tween(n.node).to(.2,{position:cc.v3(n.node.x,n.node.y+50)},{easing:"quadOut"}).to(.5+.4*a,{position:cc.v3(n.node.x,n.node.y-165*(e.childrenCount-3)-82.5)},{easing:"quadIn"}).to(.2,{position:cc.v3(n.node.x,n.node.y-165*(e.childrenCount-3))},{easing:"quadIn"}).call(()=>{n.node.y<-165&&n.node.setPosition(0,165*(e.childrenCount-3-t)+165),n.node.zIndex=e.childrenCount-1-t}).call(()=>{if(n.node.active=!0,this.isCheckTwoScatter&&a==this.colums.childrenCount-3&&0==t){let e=A.default.createAnim(this.speedSpin,cc.v2(315,15));e.node.active=!0,e.node.scaleX=.9,e.node.scaleY=.95,e.premultipliedAlpha=!1,this.node.addChild(e.node,500),e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!0),this.scheduleOnce(()=>{e.node.destroy()},1.5)}a==this.colums.childrenCount-1&&t==e.childrenCount-1&&(this.playSoundEff("stopWheel"),this.scheduleOnce(()=>{this.handleResultNormal(i)},.5))}).start()}}}handleResultNormal(e){this.playSoundEff("stopWheel"),this.initDataSpin();let t=0;e.payLines.length>0&&(t=.2*e.payLines.length);let i=0;e.payLines.length>0&&(i=this.isAutoSpin||this.spinNormalData.isBonusMiniGame?1.4:1.4*e.payLines.length);let n=0;this.spinNormalData.isBonusMiniGame&&(n=3);let a=0;this.listWild.length>0&&(a=2);let s=0;this.spinNormalData.isBonusMiniGame&&(s=1.8);let o=0;e.isGrandJackpot&&(o=3.5),e.chipsMcb,cc.tween(this.node).call(()=>{this.effectShowWild()}).delay(a).call(()=>{if(e.isGrandJackpot){let e=this.infoData.grand*this.infoData.betLevels[this.betIndex],t=A.default.createAnim(this.luckyDrawWin);this.node.addChild(t.node,500),t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"grand",!1);let i=new cc.Node("lbMoney").addComponent(cc.Label);i.font=this.fontGo3v2,i.string=l.default.formatNumberToString(e),i.fontSize=80,i.lineHeight=80,i.node.y=-70,t.node.addChild(i.node,500),this.scheduleOnce(()=>{t.node.destroy()},3)}}).delay(o).call(()=>{this.showAnimTotalWin(Number(this.totalWin),Number(e.chipsMcb),a=>{cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).delay(a).call(()=>{for(let t=0;t<e.payLines.length;t++){let i=e.payLines[t].line;for(let e=0;e<this.listColumnContainsWild.length;e++)i[this.listColumnContainsWild[e]]=9}this.getLineWin(e.payLines);for(let e=0;e<this.winningLine.length;e++)this.initLineWin(this.winningLine[e])}).call(()=>{this.updateMoney(),this.showAllWinLine()}).delay(t).call(()=>{this.showAnimOneWinLine()}).delay(i).call(()=>{this.spinNormalData.isBonusMiniGame&&this.showAnimScatter()}).delay(n).call(()=>{if(this.spinNormalData.isBonusMiniGame){let e=A.default.createAnim(this.screenBonus,cc.v2(0,0));this.node.addChild(e.node,1e3),e.node.active=!0,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!1),this.scheduleOnce(()=>{e.node.destroy()},3.5)}}).delay(s).call(()=>{this.isFinishAction=!0,this.clickSpinCount=0,this.isAutoSpin&&!this.spinNormalData.isBonusMiniGame?this.spin():this.isAutoSpin||(this.nodeBuyBalls.active=!0),this.spinNormalData.isBonusMiniGame&&this.showScatterSpinPrefab()}).start()})}).start()}getLineWin(e){for(let t=0;t<e.length;t++){let i=e[t].lineNumber,n={lineWin:[],lineWinId:[],color:null,pays:null},a=[];for(let e=0;e<this.payLine[i].length;e++){let t=this.payLine[i][e];a.push(this.reels[e][t])}n.lineWin=this.payLine[e[t].lineNumber],n.lineWinId=e[t].line,n.color=this.listColor[e[t].lineNumber],n.pays=e[t].winAmount,this.winningLine.push(n)}}initDataSpin(){for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e];for(let e=2;e>=0;e--){let i=t.children[e].getComponent(y.default);10==i.idView&&this.listScatter.push(i)}}for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e];for(let i=2;i>=0;i--){let n=t.children[i].getComponent(y.default);if(9==n.idView){this.listColumnContainsWild.push(e),this.listWild.push(n);break}}}}initLineWin(e){let t=e.lineWin,i=e.color,n=(e.lineWinId,[]),a=[];for(let s=0;s<this.colums.childrenCount;s++){let e=this.colums.children[s];for(let i=2;i>=0;i--){let o=e.children[i].getComponent(y.default);if(o.indexRow==t[s]){let e=o.getWordPosItem(o.node);n.push(e),a.push(o);break}}}this.listLineWinPos.push(n),this.listItemLineWin.push(a),this.drawLine(n,i)}drawLine(e,t){let i=this.createLine(t,!1);i.moveTo(e[0].x-90,e[0].y),i.lineTo(e[0].x,e[0].y);let n=e.length;for(let a=1;a<n;a++)i.lineJoin=cc.Graphics.LineJoin.ROUND,i.lineTo(e[a].x,e[a].y);i.lineTo(e[n-1].x+90,e[n-1].y),i.stroke(),i.node.active=!1,this.listWinLineNode.push(i)}createLine(e,t,i=5){let n=(new cc.Node).addComponent(cc.Graphics);return n.lineWidth=i,n.lineCap=cc.Graphics.LineCap.ROUND,n.strokeColor=(new cc.Color).fromHEX(e),n.node.active=!0,n.node.opacity=0,this.node.addChild(n.node,99),t&&(n.node.zIndex=100),n}resetForNextSpin(){this.sprTitleWin.spriteFrame=this.listSprTitleWin[this.gameType==d.SiXiangGame.NORMAL?2:1];for(let e=0;e<this.listWinLineNode.length;e++)this.listWinLineNode[e].node.destroy();this.listWinLineNode=[];for(let e=0;e<this.listLineRect.length;e++)this.listLineRect[e].destroy();this.listLineRect=[],this.winningLine=[],this.listScatter=[],this.listPosRect=[],this.listLineWinPos=[],this.listItemLineWin=[],this.listColumnContainsWild=[],this.listWild=[],this.lb_info.node.active=!0,this.lb_info.string=c.default.getInstance().getString("txt_playing_lines").replace("%d",25..toString()),this.itemMiniResult.active=!1,this.resetListAnim()}onClickPlusMarkBet(){this.isAutoSpin||this.gameType==d.SiXiangGame.NORMAL&&this.isFinishAction&&(this.nodeBuyBalls.children.forEach(e=>{cc.tween(e).to(.2,{x:200}).start()}),parseInt(this.lbCurrentBet.string.trim()),this.betIndex<this.infoData.betLevels.length-1?(this.betIndex++,this.betIndex===this.infoData.betLevels.length-1&&(this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[1])):(this.betIndex=0,this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[0]),this.updateJackpot(this.infoData.betLevels[this.betIndex]),S.default.updateBet(this.infoData.betLevels[this.betIndex]),this.lbCurrentBet.string=l.default.formatNumberToString(this.infoData.betLevels[this.betIndex]))}onClickMinusMarkBet(){this.isAutoSpin||this.gameType==d.SiXiangGame.NORMAL&&this.isFinishAction&&(this.nodeBuyBalls.children.forEach(e=>{cc.tween(e).to(.2,{x:200}).start()}),this.betIndex>0?(this.betIndex--,this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[0]):(this.betIndex=this.infoData.betLevels.length-1,this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[1]),this.updateJackpot(this.infoData.betLevels[this.betIndex]),S.default.updateBet(this.infoData.betLevels[this.betIndex]),this.lbCurrentBet.string=l.default.formatNumberToString(this.infoData.betLevels[this.betIndex]))}onClickMaxBet(){this.isAutoSpin||this.gameType==d.SiXiangGame.NORMAL&&this.isFinishAction&&(this.nodeBuyBalls.children.forEach(e=>{cc.tween(e).to(.2,{x:200}).start()}),this.sprTypeCurrentBet.spriteFrame=this.listSprTypeCurrentBet[1],this.betIndex=this.infoData.betLevels.length-1,this.updateJackpot(this.infoData.betLevels[this.betIndex]),S.default.updateBet(this.infoData.betLevels[this.betIndex]),this.lbCurrentBet.string=l.default.formatNumberToString(this.infoData.betLevels[this.betIndex]))}updateJackpot(e){var t,i,n,a,s,o,c,r;this.lbMinor.string=l.default.formatNumberToString(null===(i=null===(t=this.infoData.winJpHistory)||void 0===t?void 0:t.minor)||void 0===i?void 0:i.chips),this.lbMajor.string=l.default.formatNumberToString(null===(a=null===(n=this.infoData.winJpHistory)||void 0===n?void 0:n.major)||void 0===a?void 0:a.chips),this.lbMega.string=l.default.formatNumberToString(null===(o=null===(s=this.infoData.winJpHistory)||void 0===s?void 0:s.mega)||void 0===o?void 0:o.chips),this.lbGrand.string=l.default.formatNumberToString(null===(r=null===(c=this.infoData.winJpHistory)||void 0===c?void 0:c.grand)||void 0===r?void 0:r.chips)}cleanGame(){cc.sys.localStorage.setItem("isBack","false")}showAllWinLine(){if(this.lb_info.node.active=!1,this.listWinLineNode.length>0)for(let e=0;e<this.listWinLineNode.length;e++)cc.tween(this.listWinLineNode[e].node).delay(.15*e).call(()=>{this.listWinLineNode[e].node.active=!0}).start()}checkIndexToShowAnim(e){let t=0,i=e[0];for(let n=1;n<e.length;n++)if(9!==i){if(e[n]!==i&&9!==e[n])break;t++}else{if(10===e[n])break;i=e[n],t++}return t}showAnimWild(){for(let e=0;e<this.listWild.length;e++){let t=this.listWild[e];t.activeSprite(!1),t.activeAnimation(!0),t.setAnimation(9),this.scheduleOnce(()=>{t.activeSprite(!0),t.activeAnimation(!1)},2)}}effectShowWild(){var e,t,i,n;for(let a=0;a<this.listColumnContainsWild.length;a++){let s,o,l=this.colums.children[this.listColumnContainsWild[a]],c=this.listWild[a];c.activeSprite(!1),c.activeAnimation(!0),c.setAnimation(9),this.playSoundEff("wildscatter");for(let e=2;e>=0;e--){let t=l.children[e].getComponent(y.default);t.indexRow!=c.indexRow&&t.activeSprite(!1),this.reels[a]&&this.reels[a][e]&&(this.reels[a][e]=9)}2==c.indexRow?(s=c.node.y+165,o=c.node.y+330):1==c.indexRow?(s=c.node.y+165,o=c.node.y-165):0==c.indexRow&&(s=c.node.y-165,o=c.node.y-330);let r=cc.instantiate(c.node);null===(t=null===(e=null==c?void 0:c.node)||void 0===e?void 0:e.parent)||void 0===t||t.addChild(r,500),r.getComponent(y.default).setAnimation(9),cc.tween(r).to(.4,{y:s}).delay(1.5).call(()=>{r.destroy()}).start();let d=cc.instantiate(c.node);null===(n=null===(i=null==c?void 0:c.node)||void 0===i?void 0:i.parent)||void 0===n||n.addChild(d,500),d.getComponent(y.default).setAnimation(9),cc.tween(d).to(.4,{y:o}).delay(1.5).call(()=>{for(let e=2;e>=0;e--){let t=l.children[e].getComponent(y.default);t.indexRow!=c.indexRow&&(t.setSpriteFrame(9),t.activeSprite(!0))}c.activeSprite(!0),c.activeAnimation(!1),d.destroy()}).start()}}showAnimScatter(){this.resetListAnim(),this.playSoundEff("wildscatter");for(let e=0;e<this.listScatter.length;e++){let t=this.listScatter[e];t.activeSprite(!1),t.activeAnimation(!0),t.setAnimation(10),this.scheduleOnce(()=>{t.activeSprite(!0),t.activeAnimation(!1)},2)}}resetListAnim(){for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e];for(let e=2;e>=0;e--){let i=t.children[e].getComponent(y.default);i&&(i.activeSprite(!0),i.activeAnimation(!1),i.highlight(!1))}}}showAnimOneWinLine(){for(let e=0;e<this.listWinLineNode.length;e++){if((this.isAutoSpin||this.spinNormalData.isBonusMiniGame)&&1==e){for(let e=0;e<this.listWinLineNode.length;e++)this.listWinLineNode[e].node.active=!1;for(let e=0;e<this.listLineRect.length;e++)this.listLineRect[e].active=!1;return}cc.tween(this.node).delay(1.4*e).call(()=>{for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e];for(let e=2;e>=0;e--){let i=t.children[e].getComponent(y.default);i.activeSprite(!0),i.activeAnimation(!1),i.highlight(!1)}}for(let e=0;e<this.listWinLineNode.length;e++)this.listWinLineNode[e].node.active=!1;for(let e=0;e<this.listLineRect.length;e++)this.listLineRect[e].active=!1;this.listPosRect=[],this.turnOffMiniResult(),this.playSoundEff("showline"),this.listLineWinPos[e]&&this.showListAnim(this.listLineWinPos[e],this.winningLine[e].lineWinId,this.winningLine[e].color,this.winningLine[e].pays,this.winningLine[e].lineWin,this.listItemLineWin[e])}).delay(1.07).call(()=>{if(e<this.listWinLineNode.length-1)for(let e=0;e<this.colums.childrenCount;e++){let t=this.colums.children[e];for(let e=2;e>=0;e--){let i=t.children[e].getComponent(y.default);i.activeSprite(!0),i.activeAnimation(!1),i.highlight(!1)}}1==e&&(this.isCheckingShowOneLine=!0)}).start()}}showListAnim(e,t,i,n,a,s){let o=this.checkIndexToShowAnim(t),l=t[0];for(let c=0;c<=o;c++)if(9!=t[c]){l=t[c];break}for(let c=0;c<=o;c++){this.showItemAnim(c,e[c],t[c],n,s[c],l);let a=e[c],r=!1;if(o<4&&c===o&&(r=!0),c+1<=o&&(e[c].y>e[c+1].y+290||e[c].y<e[c+1].y-290)){let t=this.getCrossPoint(e[c],e[c+1]),n=this.getCrossPoint(e[c+1],e[c]),a=this.createLine(i,!1);a.moveTo(t.x,t.y),a.lineTo(n.x,n.y),a.stroke(),this.listLineRect.push(a.node)}this.drawRect(a,i,r,o,e)}}drawRect(e,t,i,n,a){let o=this.createLine(t,!0,5),l=cc.v2(e.x-s.x/2,e.y-s.y/2);if(o.moveTo(l.x,l.y),this.listLineRect.push(o.node),o.stroke(),i){let e=a.slice(n,5);this.drawLineLast(e,t)}}drawLineLast(e,t){let i=this.createLine(t,!1),n=this.getCrossPoint(e[0],e[1]);i.moveTo(n.x,n.y);let a=e.length;for(let s=1;s<a;s++)i.lineJoin=cc.Graphics.LineJoin.ROUND,i.lineTo(e[s].x,e[s].y);i.lineTo(e[a-1].x+90,e[a-1].y),i.stroke(),this.listLineRect.push(i.node)}getCrossPoint(e,t){let i=e.y>t.y?-1:1,n=cc.v2(e.x-s.x,e.y+s.y/2*i),a=cc.v2(n.x+s.x,n.y);return Math.abs(e.y-t.y)<1&&(n=cc.v2(e.x+s.x/2,e.y+s.y/2),a=cc.v2(e.x+s.x/2,e.y-s.y/2)),l.default.pIntersectPoint(n,a,e,t)}showItemAnim(e,t,i,n,a,s){a.activeSprite(!1),a.activeAnimation(!0),a.setAnimation(i),a.highlight(!0),this.setItemMiniResult(s,e,n)}setItemMiniResult(e,t,i){let n=this.animDatas[e];this.listItemMiniResult[t].skeletonData=n,this.listItemMiniResult[t].node.active=!0,this.listItemMiniResult[t].setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.listItemMiniResult[t].setAnimation(0,"animation",!0),this.lb_Result.string=l.default.formatNumberToString(i),this.itemMiniResult.active=!0}turnOffMiniResult(){for(let e=0;e<this.listItemMiniResult.length;e++)this.listItemMiniResult[e].node.active=!1}updateMoney(){this.totalWin<=0?this.lbAgUser.string=l.default.formatNumberToString(this.agPlayer):(this.sprTitleWin.spriteFrame=this.listSprTitleWin[0],this.lbChipWin.string=l.default.formatNumberToString(this.totalWin),A.default.effRunNumber(.8,this.lbAgUser,this.agPlayer-this.totalWin,this.agPlayer,.8))}showScatterSpinPrefab(){this.gameType=d.SiXiangGame.BONUS,this.scatterSpin.initScatterData(),this.scatterSpin.onPopOn(255)}setMiniGameGoldPick(e){this.nodeTop.active=!1,this.nodeMiddle.active=!1,this.lb_info.node.parent.active=!1,this.nodeBuyBalls.active=!1,this.gameType=d.SiXiangGame.GOLDPICK,this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"goldpick",!1),this.nodeGoldPick.active=!0,this.nodeGoldPick.getComponent(C.default).setInfoGoldPick(e)}setMiniGameDragonPearl(e,t,i=!1){this.nodeDragonPeals.active=!0,this.nodeBlack.active=!0,this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"dragonpearl",!1),this.nodeBuyBalls.active=!1,this.gameType=d.SiXiangGame.DRAGON_PEARL,this.nodeDragonPeals.getComponent(R.default).setInfoDragonPearls(e,i),this.nodeDragonPeals.getComponent(R.default).nodePearls.active=!0,this.setStateSpinBtn("freespinOn"),this.lbLimit.node.active=!1,this.sprLimit.node.active=!1}setMiniGameLuckyDraw(e){this.colums.active=!1,this.nodeLuckyDraw.active=!0,this.nodeBuyBalls.active=!1,this.gameType=d.SiXiangGame.LUCKDRAW,this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"luckydraw",!1),this.nodeLuckyDraw.getComponent(D.default).nodeCards.active=!0,this.nodeLuckyDraw.getComponent(D.default).setInfoLuckyDraw(e)}setMiniGameRapidPay(e){this.nodeRapidPay.active=!0,this.nodeBuyBalls.active=!1,this.gameType=d.SiXiangGame.RAPIDPAY,this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"rapidplay",!1),this.nodeRapidPay.getComponent(G.default).isAllowClick=!0,null!=e.rewards&&null!=e.rewards||(e.rewards=[]),this.nodeRapidPay.getComponent(G.default).setInfoRapidPay(e)}onClickLimitAutoSpin(e,t){let i=this.btn_Spin.node.getChildByName("boxAutoSpin");"limit"==t?this.limitAutoSpin=-999:(this.limitAutoSpin=parseInt(t),this.lbLimit.string=""+this.limitAutoSpin),cc.tween(i).to(.5,{y:-250}).call(()=>{this.spin(),this.setStateSpinBtn()}).start()}onClickAutoSpin(){(this.limitAutoSpin>0||-999==this.limitAutoSpin)&&(this.isAutoSpin=!0,this.spin(),this.setStateSpinBtn())}setPopupBonusGame(){this.resetForNextSpin();let e=this.nodePopupBonusGame.getChildByName("animPopup").getComponent(sp.Skeleton),t=this.nodePopupBonusGame.getChildByName("nodeBlack"),i=this.nodePopupBonusGame.getChildByName("nodeButton");t.opacity=0,this.nodePopupBonusGame.active=!0,i.active=!1,cc.tween(this.nodePopupBonusGame).call(()=>{e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!1),cc.tween(t).to(.5,{opacity:255}).start()}).delay(1.5).call(()=>{i.active=!0,cc.tween(i).repeatForever(cc.tween(i).call(()=>{for(let e=0;e<i.childrenCount;e++)cc.tween(i.children[e]).delay(.2*e).to(.2,{scale:1.2}).to(.2,{scale:1}).start()}).delay(1.5)).start()}).start()}onClickSelectBonusGame(e,t){let i=this.nodePopupBonusGame.getChildByName("nodeButton");cc.Tween.stopAllByTarget(i),this.handleSelectBonusGame(t)}handleGetBonusGames(e){this.nodeBuyBalls.active=!1,this.gameType!==d.SiXiangGame.NORMAL||this.isAutoSpin||(this.nodeBuyBalls.active=!0),this.dataGetBonus=e;for(let t=0;t<this.nodeDragonBalls.childrenCount;t++)this.nodeDragonBalls.children[t].getComponent(cc.Button).interactable=!1,cc.tween(this.nodeBuyBalls.children[t]).to(.5,{x:500}).start();for(let t=0;t<e.sixiangGems.length;t++){let i=0;switch(e.sixiangGems[t]){case d.SiXiangGame.DRAGON_PEARL:i=0;break;case d.SiXiangGame.GOLDPICK:i=1;break;case d.SiXiangGame.RAPIDPAY:i=2;break;case d.SiXiangGame.LUCKDRAW:i=3}this.nodeDragonBalls.children[i].getComponent(cc.Button).interactable=!0,cc.tween(this.nodeBuyBalls.children[i]).to(.5,{x:200}).start()}4==e.sixiangGems.length&&cc.error("check ra thang muc cuoc ",e.bet," duoc choi ultimate !")}onClickBuyBall(e,t){this.isAutoSpin||g.default.show(this.node,t,this.infoData.betLevels[this.betIndex],this.infoData.chipsBuyGem,this.agPlayer)}handleBuyBonusGame(e,t){let i=this.miniGameAnims[t];if(null!=i){let t=A.default.createAnim(i,cc.v2(0,0));this.node.addChild(t.node,500),t.node.active=!0,t.premultipliedAlpha=!1,t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"animation",!1),this.scheduleOnce(()=>{t.node.destroy(),this.nodeBlackTotalWin.setScale(0),S.default.buyGem(e)},6.5)}this.scheduleOnce(()=>{let e=A.default.createAnim(this.screenBonus,cc.v2(0,0));this.node.addChild(e.node,500),e.node.active=!0,e.premultipliedAlpha=!1,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!1),this.scheduleOnce(()=>{e.node.destroy()},3.5),this.resetForNextSpin(),this.sprTitleWin.spriteFrame=this.listSprTitleWin[1],this.isFinishAction=!0},5)}handleSelectBonusGame(e){this.nodePopupBonusGame.active=!1,this.isSelectBonusGame=!1,this.isBonusGame=!0;for(let t=0;t<this.nodeDragonBalls.childrenCount;t++)this.nodeDragonBalls.children[t].getComponent(cc.Button).interactable=!1,cc.tween(this.nodeBuyBalls.children[t]).to(.5,{x:500}).start();cc.tween(this.nodePopupBonusGame).call(()=>{let e=A.default.createAnim(this.screenBonus,cc.v2(0,0));this.node.addChild(e.node,1e3),e.node.active=!0,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!1),this.scheduleOnce(()=>{e.node.destroy()},3.5)}).delay(1.8).call(()=>{S.default.sendChooseBonusGame(this.infoData.betLevels[this.betIndex],this.sixiang_symbol_sixangbonus[e])}).start()}onClickFinish(){if(this.nodeAnimWin.active=!1,this.isFinishAction=!1,this.nodeBuyBalls.active=!0,this.gameType===d.SiXiangGame.NORMAL)return;let e="normal",t=0;switch((this.isBonusGame||this.isSelectBonusGame)&&(t=1.5),cc.tween(this.nodeAnimWin).call(()=>{if(!this.isBonusGame){switch(this.gameType){case d.SiXiangGame.DRAGON_PEARL:e="blue_rong";break;case d.SiXiangGame.LUCKDRAW:e="green_rong";break;case d.SiXiangGame.GOLDPICK:e="white_rong";break;case d.SiXiangGame.RAPIDPAY:e="red_rong";break;default:e="normal"}cc.tween(this.animRong.node).call(()=>{this.animRong.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animRong.setAnimation(0,e,!1)}).start()}}).delay(t).call(()=>{this.isBonusGame||(this.animRong.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animRong.setAnimation(0,"normal",!1))}).delay(t).call(()=>{this.isFinishAction=!0,this.gameType=d.SiXiangGame.NORMAL,this.isBonusGame=!1,this.isSelectBonusGame?this.setPopupBonusGame():this.scheduleOnce(()=>{this.isAutoSpin&&this.onClickAutoSpin()},.5)}).start(),this.gameType){case d.SiXiangGame.DRAGON_PEARL:this.nodeDragonPeals.getComponent(R.default).finishGameDragonPearl();break;case d.SiXiangGame.LUCKDRAW:this.nodeLuckyDraw.getComponent(D.default).finishLuckyDraw();break;case d.SiXiangGame.GOLDPICK:this.nodeGoldPick.getComponent(C.default).finishGoldPick();break;case d.SiXiangGame.RAPIDPAY:this.nodeRapidPay.getComponent(G.default).finishGameRapidPay()}this.aniGameName.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.aniGameName.setAnimation(0,"sixiang",!1),S.default.getMatchResult()}setCallbackForceClose(e){this.callbackForceClose=e}onClickNodeBlackTotalWin(e,t){cc.tween(this.nodeBlackTotalWin).to(.5,{scale:0}).call(()=>{this.callbackForceClose&&(this.callbackForceClose(),this.unscheduleAllCallbacks()),this.callbackForceClose=null}).start()}onClickSkip(e,t){let i=this.nodeBlackTotalWin.getChildByName("btnSkip");i&&(i.active=!1);let n=this.nodeBlackTotalWin.getChildByName("animTotalWin");n&&(n.active=!1);let a=this.nodeBlackTotalWin.getChildByName("animskip");a&&(a.active=!0),this.scheduleOnce(()=>{this.onClickNodeBlackTotalWin(null,null)},1)}onClickRule(){p.default.show(this.node)}onQuit(){r.BannerData.setBannerData(o.Banner.ShowType.LEFT_MATCH,!0,o.Game.Enum.SIXIANG),f.default.onQuit()}playSoundEff(e){}showAnimTotalWin(e,t,i){let n="";if(this.timeShowAnimBigWin=0,e>50*t)n="megawin2",this.timeShowAnimBigWin=d.TimeBigWin.MEGA_WIN;else if(e>25*t)n="hugewin2",this.timeShowAnimBigWin=d.TimeBigWin.HUGE_WIN;else if(e>10*t)n="bigwin2",this.timeShowAnimBigWin=d.TimeBigWin.BIG_WIN;else{if(!(e>5*t))return void(null!=i&&i(0));n="nicewin2",this.timeShowAnimBigWin=d.TimeBigWin.NICE_WIN}this.playSoundEff("bigwin"),this.nodeBlackTotalWin.setScale(1),this.nodeBlackTotalWin.removeAllChildren();let a=A.default.createAnim(this.bigwin_amin,cc.v2(0,0));a.node.parent=this.nodeBlackTotalWin,a.node.zIndex=900,a.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),a.setAnimation(0,"money",!0);let s=A.default.createAnim(this.bigwin_amin,cc.v2(0,0));s.node.name="animskip",s.node.parent=this.nodeBlackTotalWin,s.node.zIndex=950,s.node.active=!1,s.timeScale=50,s.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),s.setAnimation(0,n,!1);let o=new cc.Node("lb_Money").addComponent(cc.Label);o.fontSize=25,o.lineHeight=40,o.node.position=cc.v3(0,-160),o.node.parent=s.node,o.string=l.default.formatNumber(e);let c=A.default.createAnim(this.bigwin_amin,cc.v2(0,0));c.node.name="animTotalWin",c.node.parent=this.nodeBlackTotalWin,c.node.zIndex=950,c.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),c.setAnimation(0,n,!1);let r=cc.instantiate(this.btnSkipTotalWin);r.name="btnSkip",r.active=!0,r.position=cc.v3(0,-cc.winSize.width/2+80),r.parent=this.nodeBlackTotalWin,r.zIndex=1e3;let h=new cc.Node("lb_Money").addComponent(cc.Label);h.fontSize=25,h.lineHeight=40,h.node.position=cc.v3(0,-160),h.node.parent=c.node,h.string="0",h.font=this.number_win_font,o.font=this.number_win_font,A.default.createEffNumRun(h,0,e,this.timeShowAnimBigWin-4);let m=this.timeShowAnimBigWin;this.scheduleOnce(()=>{r.active=!1},m-1.5),this.scheduleOnce(()=>{c.node.destroy(),cc.tween(this.nodeBlackTotalWin).to(0,{scale:0}).call(()=>{}).start()},m),this.setCallbackForceClose(null),null!=i&&(i(m),this.setCallbackForceClose(i))}};P.instance=null,a([I(cc.Node)],P.prototype,"colums",void 0),a([I(cc.Node)],P.prototype,"nodeTop",void 0),a([I(cc.Node)],P.prototype,"nodeMiddle",void 0),a([I(cc.Prefab)],P.prototype,"itemPrefab",void 0),a([I(cc.Label)],P.prototype,"lbCurrentBet",void 0),a([I(cc.Sprite)],P.prototype,"sprTypeCurrentBet",void 0),a([I(cc.Label)],P.prototype,"lbTitleWin",void 0),a([I(cc.Sprite)],P.prototype,"sprTitleWin",void 0),a([I(cc.Label)],P.prototype,"lbAgUser",void 0),a([I(cc.Label)],P.prototype,"lbChipWin",void 0),a([I(cc.Label)],P.prototype,"lb_Result",void 0),a([I(cc.Label)],P.prototype,"lb_info",void 0),a([I(sp.Skeleton)],P.prototype,"aniChipWin",void 0),a([I(sp.Skeleton)],P.prototype,"aniGameName",void 0),a([I(cc.Button)],P.prototype,"btn_Spin",void 0),a([I([sp.Skeleton])],P.prototype,"listItemMiniResult",void 0),a([I(cc.Node)],P.prototype,"itemMiniResult",void 0),a([I(cc.Label)],P.prototype,"lbMinor",void 0),a([I(cc.Label)],P.prototype,"lbMajor",void 0),a([I(cc.Label)],P.prototype,"lbMega",void 0),a([I(cc.Label)],P.prototype,"lbGrand",void 0),a([I(b.default)],P.prototype,"scatterSpin",void 0),a([I(cc.Node)],P.prototype,"nodeGoldPick",void 0),a([I(cc.Node)],P.prototype,"nodeDragonPeals",void 0),a([I(cc.Node)],P.prototype,"nodeLuckyDraw",void 0),a([I(cc.Node)],P.prototype,"nodeRapidPay",void 0),a([I(cc.Node)],P.prototype,"nodeBlack",void 0),a([I(cc.Node)],P.prototype,"nodeAnimWin",void 0),a([I(cc.Node)],P.prototype,"nodeBlackTotalWin",void 0),a([I(sp.Skeleton)],P.prototype,"animRong",void 0),a([I(cc.Node)],P.prototype,"nodeDragonBalls",void 0),a([I(cc.Node)],P.prototype,"nodePopupBonusGame",void 0),a([I(cc.Node)],P.prototype,"nodeBuyBalls",void 0),a([I([cc.SpriteFrame])],P.prototype,"listSprTypeCurrentBet",void 0),a([I([cc.SpriteFrame])],P.prototype,"listSprTitleWin",void 0),a([I([sp.SkeletonData])],P.prototype,"animDatas",void 0),a([I(sp.SkeletonData)],P.prototype,"speedSpin",void 0),a([I(sp.SkeletonData)],P.prototype,"luckyDrawWin",void 0),a([I(cc.Font)],P.prototype,"fontGo3v2",void 0),a([I(sp.SkeletonData)],P.prototype,"screenBonus",void 0),a([I([sp.SkeletonData])],P.prototype,"miniGameAnims",void 0),a([I(cc.Node)],P.prototype,"btnSkipTotalWin",void 0),a([I(sp.SkeletonData)],P.prototype,"bigwin_amin",void 0),a([I(cc.Font)],P.prototype,"number_win_font",void 0),P=n=a([k],P),i.default=P,cc._RF.pop()},{"../../lobby/src/chat/ChatPresenter":void 0,"../../lobby/src/common/Constants":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/common/Utils":void 0,"../../lobby/src/dialogs/banner/BannerDialog":void 0,"../../lobby/src/dialogs/option/OptionDialog":void 0,"../../lobby/src/language/LanguageController":void 0,"./SixiangBuyChipDialog":"SixiangBuyChipDialog","./SixiangConstants":"SixiangConstants","./SixiangDragonPearl":"SixiangDragonPearl","./SixiangItem":"SixiangItem","./SixiangLuckyDraw":"SixiangLuckyDraw","./SixiangNetworkTransport":"SixiangNetworkTransport","./SixiangPickGold":"SixiangPickGold","./SixiangPresenter":"SixiangPresenter","./SixiangRapidPay":"SixiangRapidPay","./SixiangRuleDialog":"SixiangRuleDialog","./SixiangScatterSpin":"SixiangScatterSpin","./SixiangUtils":"SixiangUtils"}],SixiangDragonPearl:[function(e,t,i){"use strict";cc._RF.push(t,"9908frAgn1Dd4fJDW8I55Hw","SixiangDragonPearl");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/language/LanguageController"),s=e("../../lobby/src/common/Utils"),o=e("./SixiangAnimWin"),l=e("./SixiangConstants"),c=e("./SixiangUtils"),r=e("./SixiangItem"),d=e("./SixiangController"),{ccclass:h,property:m}=cc._decorator;let u=class extends cc.Component{constructor(){super(...arguments),this.nodePearls=null,this.lbBonusFreeSpin=null,this.fontWin=null,this.sprGold=null,this.luckyDrawWin=null,this.dargonPealAmin=[],this.listItemPearlBonus=[],this.listItemPearlNomarl=[],this.listItemPearlDouble=[],this.isStart=!1,this.mapAminIndex={}}onLoad(){this.listItemPearlBonus=[],this.listItemPearlNomarl=[],this.listItemPearlDouble=[],this.isStart=!1,this.mapAminIndex={phongbi:0,eye_phoenix:1,eye_tiger:2,eye_turtle:3,eye_dragon:4,gold_ingot:5}}setInfoDragonPearls(e,t){if(this.isStart)return void this.handleDragonPearl(e);this.unscheduleAllCallbacks(),d.default.getInstance().isFinishAction=!1;for(let n=0;n<d.default.getInstance().colums.childrenCount;n++){let e=d.default.getInstance().colums.children[n];for(let t=e.childrenCount-1;t>=0;t--)e.children[t].getComponent(r.default).setSpriteFrame(c.default.getRanNum(0,10),!0)}this.resetDisplay();let i=[];for(let n=0;n<e.matrix.spinLists.length;n++)e.matrix.spinLists[n].symbol>0&&i.push(e.matrix.spinLists[n]);for(let n=0;n<i.length;n++)cc.tween(d.default.getInstance().node).delay(.5+.5*n).call(()=>{let e=(new cc.Node).addComponent(cc.Sprite);e.spriteFrame=this.sprGold,d.default.getInstance().node.addChild(e.node,500);let t=i[n].col,a=i[n].row,s=this.nodePearls.children[t].children[a],o=s.parent.convertToWorldSpaceAR(cc.v3(s.position)),l=d.default.getInstance().node.convertToNodeSpaceAR(o);e.node.setPosition(-430,195),e.node.scale=0,cc.tween(e.node).parallel(cc.tween().to(1,{scale:1}),cc.tween().to(1,{position:l})).delay(1).call(()=>{e.node.destroy()}).start()}).delay(1).call(()=>{this.initPearlItem(e,i[n],!0),n==i.length-1&&(d.default.getInstance().lb_info.string=e.numSpinLeft+" Free spin left",d.default.getInstance().lbChipWin.string=s.default.formatNumber(Number(e.gameReward.totalChipsWinByGame)),this.isStart=!0,this.scheduleOnce(()=>{d.default.getInstance().isFinishAction=!0,d.default.getInstance().spin()},1.5))}).start()}handleResultDragonPearl(e){let t=2;e.spinSymbols[0].symbol>l.SiXiangSymbolDragonPearl.GEM_RANDOM5&&(t=6);let i=(this.listItemPearlNomarl.length,t),n=0;e.spinSymbols[0].symbol===l.SiXiangSymbolDragonPearl.JP_GRAND&&(n=3.5),d.default.getInstance().timeShowAnimBigWin=0,e.spinSymbols&&0!==e.spinSymbols.length&&cc.tween(this.nodePearls).call(()=>{d.default.getInstance().numberOfDragonPearlSpins=e.numSpinLeft;for(let t=0;t<this.listItemPearlNomarl.length;t++)this.initPearlItem(e,this.listItemPearlNomarl[t],!1)}).delay(i).call(()=>{if(e.spinSymbols[0].symbol===l.SiXiangSymbolDragonPearl.JP_GRAND){let t=e.gameReward.chipsWin,i=c.default.createAnim(this.luckyDrawWin);d.default.getInstance().node.addChild(i.node,500),i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"grand",!1);let n=new cc.Node("lbMoney").addComponent(cc.Label);n.font=this.fontWin,n.string=s.default.formatNumber(t),n.fontSize=80,n.lineHeight=80,n.node.y=-70,i.node.addChild(n.node,500),this.scheduleOnce(()=>{i.node.destroy()},3.5)}}).delay(n).call(()=>{e.isFinishGame&&d.default.getInstance().showAnimTotalWin(Number(e.gameReward.totalChipsWinByGame),Number(e.chipsMcb),t=>{d.default.getInstance().isFinishAction=!0,this.scheduleOnce(()=>{this.showResultDragonPearls(e)},t)})}).delay(d.default.getInstance().timeShowAnimBigWin).call(()=>{d.default.getInstance().lbAgUser.string=s.default.formatNumber(Number(e.gameReward.balanceChipsWalletAfter)),d.default.getInstance().lbChipWin.string=s.default.formatNumber(Number(e.gameReward.totalChipsWinByGame)),d.default.getInstance().isFinishAction=!0,e.isFinishGame||d.default.getInstance().spin()}).start()}initPearlItem(e,t,i=!1){let n=this.nodePearls.children[t.col].children[t.row],a=n.getChildByName("skeleton").getComponent(sp.Skeleton),s=n.getChildByName("lbMoney").getComponent(cc.Label),o=0;t.symbol>l.SiXiangSymbolDragonPearl.GEM_RANDOM5&&(o=1.5),cc.tween(this.node).call(()=>{n.active=!0,s.node.active=!1,t.symbol>l.SiXiangSymbolDragonPearl.GEM_RANDOM5?(s.node.active=!1,cc.tween(a.node).call(()=>{a.skeletonData=this.dargonPealAmin[this.mapAminIndex.phongbi],a.premultipliedAlpha=!1,a.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),a.setAnimation(0,"animation",!0)}).delay(1.5).call(()=>{let e=null;switch(t.symbol){case l.SiXiangSymbolDragonPearl.EYE_BIRD:e=this.dargonPealAmin[this.mapAminIndex.eye_phoenix];break;case l.SiXiangSymbolDragonPearl.EYE_TIGER:e=this.dargonPealAmin[this.mapAminIndex.eye_tiger];break;case l.SiXiangSymbolDragonPearl.EYE_WARRIOR:e=this.dargonPealAmin[this.mapAminIndex.eye_turtle];break;case l.SiXiangSymbolDragonPearl.EYE_DRAGON:e=this.dargonPealAmin[this.mapAminIndex.eye_dragon]}a.skeletonData=e,a.premultipliedAlpha=!1,a.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),a.setAnimation(0,"animation",!1)}).delay(o).call(()=>{this.setEffectLucky(t,a,s,i)}).start()):this.effectResultGold(t)}).start()}handleDragonPearl(e){if(d.default.getInstance().isSelectBonusGame=e.isSelectBonusGame,this.listItemPearlNomarl=[],this.listItemPearlDouble=[],this.listItemPearlBonus=[],this.listItemPearlNomarl.push(e.spinSymbols[0]),e.spinSymbols[0].symbol===l.SiXiangSymbolDragonPearl.EYE_WARRIOR)for(let t=1;t<e.spinSymbols.length;t++)this.listItemPearlBonus.push(e.spinSymbols[t]);else if(e.spinSymbols[0].symbol===l.SiXiangSymbolDragonPearl.EYE_TIGER)for(let t=0;t<e.matrix.spinLists.length;t++)e.matrix.spinLists[t].symbol>=l.SiXiangSymbolDragonPearl.GEM_RANDOM1&&e.matrix.spinLists[t].symbol<=l.SiXiangSymbolDragonPearl.GEM_RANDOM5&&this.listItemPearlDouble.push(e.matrix.spinLists[t]);d.default.getInstance().isCheckReceivedData=!0;for(let t=0;t<d.default.getInstance().colums.childrenCount;t++){let e=d.default.getInstance().colums.children[t];for(let t=e.childrenCount-4;t>=3;t--)e.children[t].getComponent(r.default).setSpriteFrame(c.default.getRanNum(0,17),!0);for(let i=e.childrenCount-1;i>=e.childrenCount-3;i--){let n=e.children[i].getComponent(r.default);n.setIndexRow(e.childrenCount-1-i),n.setIndexCol(t);for(let e=0;e<this.listItemPearlNomarl.length;e++)if(n.indexCol==this.listItemPearlNomarl[e].col&&n.indexRow==this.listItemPearlNomarl[e].row){1==this.listItemPearlNomarl[e].symbol?n.setSpriteFrame(13):n.setSpriteFrame(11);break}}}for(let t=0;t<d.default.getInstance().colums.childrenCount;t++){let i=d.default.getInstance().colums.children[t];for(let n=0;n<i.childrenCount;n++){let a=i.children[n].getComponent(r.default);a.node.active=!0,cc.tween(a.node).to(.2,{position:cc.v3(a.node.x,a.node.y+20,0)},{easing:cc.easing.quadOut}).to(.2+.2*t,{position:cc.v3(a.node.x,a.node.y-165*(i.childrenCount-3)-82.5,0)},{easing:cc.easing.quadIn}).to(.2,{position:cc.v3(a.node.x,a.node.y-165*(i.childrenCount-3),0)},{easing:cc.easing.quadIn}).call(()=>{a.node.y<-165&&(a.node.setPosition(cc.v3(0,165*(i.childrenCount-3-n)+165,0)),a.node.zIndex=i.childrenCount-1-n),a.node.zIndex=i.childrenCount-1-n,t==d.default.getInstance().colums.childrenCount-1&&n==i.childrenCount-1&&this.handleResultDragonPearl(e)}).call(()=>{a.node.active=!0}).start()}}}resetDisplay(){for(let e=0;e<this.nodePearls.childrenCount;e++)for(let t=0;t<this.nodePearls.children[e].childrenCount;t++)this.nodePearls.children[e].children[t].active=!1;for(let e=0;e<d.default.getInstance().colums.childrenCount;e++){let t=d.default.getInstance().colums.children[e];for(let i=0;i<t.childrenCount;i++){let n=t.children[i].getComponent(r.default);i<3?n.setIndexRow(2-i):n.setIndexRow(i),n.setIndexCol(e)}}}finishGameDragonPearl(){d.default.getInstance().lb_info.string=a.default.getInstance().getString("txt_playing_lines").replace("%d","25"),this.node.active=!1,this.nodePearls.active=!1,d.default.getInstance().colums.active=!0,d.default.getInstance().isFinishAction=!0,d.default.getInstance().nodeBlack.active=!1,this.isStart=!1;for(let e=0;e<d.default.getInstance().colums.childrenCount;e++){let t=d.default.getInstance().colums.children[e];for(let e=2;e>=0;e--)t.children[e].getComponent(r.default).setSpriteFrame(c.default.getRanNum(0,10))}}setEffectLucky(e,t,i,n){if(n&&e.symbol!=l.SiXiangSymbolDragonPearl.EYE_DRAGON)return;let a=d.default.getInstance().colums.children[e.col].children[e.row].getComponent(r.default),o=a.getWordPosItem(a.node);if(e.symbol===l.SiXiangSymbolDragonPearl.EYE_BIRD){let e=cc.instantiate(this.lbBonusFreeSpin.node);e.active=!0,e.getComponent(cc.Label).string="3",e.setPosition(o),e.setScale(3),d.default.getInstance().node.addChild(e,500),cc.tween(e).to(.5,{position:cc.v3(o.x,o.y+50,0)}).delay(1).parallel(cc.tween().to(.5,{position:cc.v3(0,-222,0)}),cc.tween().to(.5,{scale:1})).call(()=>{e.destroy(),d.default.getInstance().lb_info.string=d.default.getInstance().numberOfDragonPearlSpins+" Free spin left"}).start()}else if(e.symbol===l.SiXiangSymbolDragonPearl.EYE_TIGER)for(let l=0;l<this.listItemPearlDouble.length;l++){let e=this.nodePearls.children[this.listItemPearlDouble[l].col].children[this.listItemPearlDouble[l].row],t=e.getChildByName("lbMoney").getComponent(cc.Label),i=e.getChildByName("skeleton").getComponent(sp.Skeleton);t.node.active=!0,t.node.scale=0,cc.tween(t.node).call(()=>{t.string=s.default.formatMoneyChip(this.listItemPearlDouble[l].winAmount),i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"rung",!1)}).to(.5,{scale:1.5}).to(.5,{scale:1}).call(()=>{d.default.getInstance().lb_info.string=d.default.getInstance().numberOfDragonPearlSpins+" Free spin left"}).start()}else if(e.symbol===l.SiXiangSymbolDragonPearl.EYE_WARRIOR)for(let s=0;s<this.listItemPearlBonus.length;s++){let e=new cc.Node("nodeSprBonus").addComponent(cc.Sprite);e.spriteFrame=this.sprGold,e.node.setPosition(o),d.default.getInstance().node.addChild(e.node,500);let t=d.default.getInstance().colums.children[this.listItemPearlBonus[s].col].children[this.listItemPearlBonus[s].row].getComponent(r.default),i=t.getWordPosItem(t.node);cc.tween(e.node).to(.5,{position:cc.v3(i.x,i.y,0)}).call(()=>{this.effectResultGold(this.listItemPearlBonus[s])}).delay(1).call(()=>{d.default.getInstance().lb_info.string=d.default.getInstance().numberOfDragonPearlSpins+" Free spin left",e.node.destroy()}).start()}else e.symbol===l.SiXiangSymbolDragonPearl.EYE_DRAGON&&(t.skeletonData=this.dargonPealAmin[this.mapAminIndex.gold_ingot],t.premultipliedAlpha=!1,t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"start2",!1),this.scheduleOnce(()=>{t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"rung2",!1),this.scheduleOnce(()=>{switch(t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"normal2",!1),i.node.active=!0,e.winJp){case l.SiXiangJackpot.MINOR:i.string="MINOR";break;case l.SiXiangJackpot.MAJOR:i.string="MAJOR";break;case l.SiXiangJackpot.MEGA:i.string="MEGA";break;case l.SiXiangJackpot.GRAND:i.string="GRAND"}i.node.scale=0,cc.tween(i.node).to(.5,{scale:1.2}).to(.5,{scale:1}).call(()=>{d.default.getInstance().lb_info.string=d.default.getInstance().numberOfDragonPearlSpins+" Free spin left"}).start()},1.5)},1))}effectResultGold(e){let t=this.nodePearls.children[e.col].children[e.row],i=t.getChildByName("skeleton").getComponent(sp.Skeleton),n=t.getChildByName("lbMoney").getComponent(cc.Label);n.string="0",t.active=!0,cc.tween(i.node).call(()=>{i.skeletonData=this.dargonPealAmin[this.mapAminIndex.gold_ingot],i.premultipliedAlpha=!1,i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"start",!1)}).delay(1.5).call(()=>{i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"rung",!1),n.node.scale=0,n.node.active=!0,n.string=s.default.formatMoneyChip(e.winAmount),cc.tween(n.node).to(.5,{scale:1.2}).to(.5,{scale:1}).start(),d.default.getInstance().lb_info.string=d.default.getInstance().numberOfDragonPearlSpins+" Free spin left"}).delay(1.5).call(()=>{i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"normal",!1)}).start()}showResultDragonPearls(e){d.default.getInstance().agPlayer=e.gameReward.balanceChipsWalletAfter,d.default.getInstance().totalWinMiniGame=e.gameReward.totalChipsWinByGame,s.default.runNumber(d.default.getInstance().lbAgUser,Number(e.gameReward.balanceChipsWalletAfter),.8),d.default.getInstance().nodeAnimWin.active=!0,d.default.getInstance().isFinishAction=!0,d.default.getInstance().nodeAnimWin.getComponent(o.default).setInfoResult(e.gameReward.totalChipsWinByGame,d.default.getInstance().gameType),d.default.getInstance().isAutoSpin?d.default.getInstance().setStateSpinBtn("autoSpin"):d.default.getInstance().setStateSpinBtn()}};n([m(cc.Node)],u.prototype,"nodePearls",void 0),n([m(cc.Label)],u.prototype,"lbBonusFreeSpin",void 0),n([m(cc.Font)],u.prototype,"fontWin",void 0),n([m(cc.SpriteFrame)],u.prototype,"sprGold",void 0),n([m(sp.SkeletonData)],u.prototype,"luckyDrawWin",void 0),n([m([sp.SkeletonData])],u.prototype,"dargonPealAmin",void 0),u=n([h],u),i.default=u,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0,"../../lobby/src/language/LanguageController":void 0,"./SixiangAnimWin":"SixiangAnimWin","./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController","./SixiangItem":"SixiangItem","./SixiangUtils":"SixiangUtils"}],SixiangIntro:[function(e,t,i){"use strict";cc._RF.push(t,"4bb72iKbQNCOqkCRu10iut1","SixiangIntro");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:a,property:s}=cc._decorator;let o=class extends cc.Component{constructor(){super(...arguments),this.callbackPlay=null,this.callbackComplete=null,this.video=null}onLoad(){this.callbackPlay=null,this.callbackComplete=null,this.video=this.node.getComponent(cc.VideoPlayer)}start(){1280/720>cc.winSize.width/cc.winSize.height?this.video.node.setContentSize(cc.winSize.height*(1280/720),cc.winSize.height):this.video.node.setContentSize(cc.winSize.width,cc.winSize.width/(1280/720)),this.video.node.active=!0}setListenerPlay(e){this.callbackPlay=e}setListenerCompleted(e){this.callbackComplete=e}eventVideo(e,t){t===cc.VideoPlayer.EventType.READY_TO_PLAY||e===cc.VideoPlayer.EventType.META_LOADED?(this.video.play(),this.callbackPlay&&this.callbackPlay()):t===cc.VideoPlayer.EventType.COMPLETED&&(this.callbackComplete&&this.callbackComplete(),this.node.active=!1)}};o=n([a],o),i.default=o,cc._RF.pop()},{}],SixiangItem:[function(e,t,i){"use strict";cc._RF.push(t,"f01abeh95FLVqQLU+uSrmLF","SixiangItem");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("./SixiangController"),{ccclass:s,property:o}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.spr=null,this.anim=null,this.animHighlight=null,this.sprFrames=[],this.sprBlurFrames=[],this.animDatas=[],this.idView=0,this.indexCol=0,this.indexRow=0}setIndexRow(e){this.indexRow=e}setIndexCol(e){this.indexCol=e}setSpriteFrame(e,t=!1){this.spr.spriteFrame=this.sprFrames[e],this.spr.node.color=t?cc.color(90,90,90,255):cc.color(255,255,255,255),this.idView=e}setSpriteBlurFrame(e){this.spr.spriteFrame=this.sprBlurFrames[e]}setAnimation(e){this.anim.skeletonData=this.animDatas[e],this.activeAnimation(!0)}activeSprite(e){this.spr.node.active=e}activeAnimation(e){this.anim.node.active=e,this.anim.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.anim.setAnimation(0,"animation",!0)}highlight(e){this.animHighlight.node.active=e,this.animHighlight.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animHighlight.setAnimation(0,"animation",!0)}getWordPosItem(e){let t=this.node.parent.convertToWorldSpaceAR(e.position);return a.default.getInstance().node.convertToNodeSpaceAR(t)}};n([o(cc.Sprite)],l.prototype,"spr",void 0),n([o(sp.Skeleton)],l.prototype,"anim",void 0),n([o(sp.Skeleton)],l.prototype,"animHighlight",void 0),n([o([cc.SpriteFrame])],l.prototype,"sprFrames",void 0),n([o([cc.SpriteFrame])],l.prototype,"sprBlurFrames",void 0),n([o([sp.SkeletonData])],l.prototype,"animDatas",void 0),l=n([s],l),i.default=l,cc._RF.pop()},{"./SixiangController":"SixiangController"}],SixiangLuckyDraw:[function(e,t,i){"use strict";cc._RF.push(t,"ced8eGqW3xGALBg9Jc1zgcO","SixiangLuckyDraw");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/common/Utils"),s=e("./SixiangAnimWin"),o=e("./SixiangConstants"),l=e("./SixiangController"),c=e("./SixiangPresenter"),r=e("./SixiangUtils"),{ccclass:d,property:h}=cc._decorator;let m=class extends cc.Component{constructor(){super(...arguments),this.nodeCards=null,this.fontLuckyDraw=null,this.luckyDrawWin=null,this.isAllowClick=!0,this.isStart=!1,this.nodeTarget=null}onLoad(){this.isAllowClick=!0,this.isStart=!1}setInfoLuckyDraw(e){if(this.isStart)this.handleLuckyDraw(e);else{if(this.unscheduleAllCallbacks(),this.resetDisplay(),e.spinSymbols&&e.spinSymbols.length>0){let t=this.nodeCards.children[e.spinSymbols[0].index],i=t.getChildByName("anim").getComponent(sp.Skeleton),n=t.getChildByName("lbMoney").getComponent(cc.Label),s="normal";switch(e.spinSymbols[0].symbol){case o.SiXiangSymbolLuckyDraw.MINOR:s="normal_minor";break;case o.SiXiangSymbolLuckyDraw.MAJOR:s="normal_major";break;case o.SiXiangSymbolLuckyDraw.MEGA:s="normal_mega";break;case o.SiXiangSymbolLuckyDraw.GRAND:s="normal_grand";break;default:s="normal",n.node.active=!0,n.string=a.default.formatMoneyChip(e.gameReward.chipsWin)}i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,s,!0)}this.scheduleOnce(this.pickRamdom,10),this.isStart=!0}}pickRamdom(){if(!this.nodeCards.children)return;if(!this.isAllowClick)return;let e=this.nodeCards.children.filter(e=>"normal"==e.getChildByName("anim").getComponent(sp.Skeleton).animation&&!e.getChildByName("lbMoney").active),t=e[Math.floor(Math.random()*e.length)];if(t){let e=this.nodeCards.children.indexOf(t);c.default.sendSpinWithIndex(e),this.isAllowClick=!1,this.nodeTarget=t,this.scheduleOnce(()=>{this.isAllowClick=!0,this.scheduleOnce(this.pickRamdom,.5)},.5)}else this.scheduleOnce(()=>{this.isAllowClick=!0,this.scheduleOnce(this.pickRamdom,.5)},.5)}onClickSendPackageLuckyDraw(e,t){this.isAllowClick&&(this.unschedule(this.pickRamdom),this.scheduleOnce(this.pickRamdom,5),this.isAllowClick=!1,this.nodeTarget=e.target,c.default.sendSpinWithIndex(parseInt(t)),this.scheduleOnce(()=>{this.isAllowClick=!0},.5))}handleLuckyDraw(e){e.isFinishGame&&this.unscheduleAllCallbacks(),l.default.getInstance().isSelectBonusGame=e.isSelectBonusGame,l.default.getInstance().lbAgUser.string=a.default.formatNumber(Number(e.gameReward.balanceChipsWalletAfter)),l.default.getInstance().lbChipWin.string=a.default.formatNumber(Number(e.gameReward.totalChipsWinByGame));let t=0;e.spinSymbols&&0!==e.spinSymbols.length&&(e.spinSymbols[0].symbol<=o.SiXiangSymbolLuckyDraw.GRAND&&e.isFinishGame&&(t=3.5),this.nodeTarget=this.nodeCards.children[e.spinSymbols[0].index],cc.tween(this.node).call(()=>{this.effectClickLuckyDraw(this.nodeTarget,e)}).delay(2).call(()=>{if(e.spinSymbols[0].symbol>o.SiXiangSymbolLuckyDraw.GRAND||!e.isFinishGame)return;let t="animation",i=0;switch(e.spinSymbols[0].symbol){case o.SiXiangSymbolLuckyDraw.MINOR:t="minor",i=e.winJpHistory.minor.chips;break;case o.SiXiangSymbolLuckyDraw.MAJOR:t="major",i=e.winJpHistory.major.chips;break;case o.SiXiangSymbolLuckyDraw.MEGA:t="mega",i=e.winJpHistory.mega.chips;break;case o.SiXiangSymbolLuckyDraw.GRAND:t="grand",i=e.winJpHistory.grand.chips}let n=r.default.createAnim(this.luckyDrawWin);l.default.getInstance().node.addChild(n.node,999),n.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),n.setAnimation(0,t,!1);let s=new cc.Node("lbMoney").addComponent(cc.Label);s.font=this.fontLuckyDraw,s.string=a.default.formatNumber(parseInt(i.toString())),s.fontSize=80,s.lineHeight=80,s.node.y=-70,n.node.addChild(s.node,999),this.scheduleOnce(()=>{n.node.destroy()},3)}).delay(t).call(()=>{e.isFinishGame&&l.default.getInstance().showAnimTotalWin(Number(e.gameReward.totalChipsWinByGame),Number(e.chipsMcb),t=>{this.scheduleOnce(()=>{this.showPopupFinish(e)},t)})}).delay(l.default.getInstance().timeShowAnimBigWin).start())}effectClickLuckyDraw(e,t){let i=e.getChildByName("anim").getComponent(sp.Skeleton),n=e.getChildByName("lbMoney").getComponent(cc.Label),s="quay_normal";if(t.spinSymbols[0].symbol>o.SiXiangSymbolLuckyDraw.GRAND)n.node.active=!0,n.string=a.default.formatMoneyChip(t.gameReward.chipsWin),n.node.scale=0,cc.tween(n.node).to(.5,{scale:1.2}).to(.2,{scale:1}).start();else switch(n.node.active=!1,t.spinSymbols[0].symbol){case o.SiXiangSymbolLuckyDraw.MINOR:s="quay_minor";break;case o.SiXiangSymbolLuckyDraw.MAJOR:s="quay_major";break;case o.SiXiangSymbolLuckyDraw.MEGA:s="quay_mega";break;case o.SiXiangSymbolLuckyDraw.GRAND:s="quay_grand"}i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,s,!1)}finishLuckyDraw(){l.default.getInstance().colums.active=!0,this.node.active=!1,this.nodeCards.active=!1,l.default.getInstance().isFinishAction=!0,this.isStart=!1,this.resetDisplay()}resetDisplay(){for(let e=0;e<this.nodeCards.childrenCount;e++){let t=this.nodeCards.children[e].getChildByName("anim").getComponent(sp.Skeleton),i=this.nodeCards.children[e].getChildByName("lbMoney").getComponent(cc.Label);t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"normal",!0),i.node.active=!1}this.isAllowClick=!0}showPopupFinish(e){this.isAllowClick=!1,l.default.getInstance().totalWinMiniGame=Number(e.gameReward.totalChipsWinByGame),l.default.getInstance().agPlayer=Number(e.gameReward.balanceChipsWalletAfter),a.default.runNumber(l.default.getInstance().lbAgUser,Number(e.gameReward.balanceChipsWalletAfter),.8),l.default.getInstance().nodeAnimWin.active=!0,l.default.getInstance().nodeAnimWin.getComponent(s.default).setInfoResult(e.gameReward.totalChipsWinByGame,l.default.getInstance().gameType)}};n([h(cc.Node)],m.prototype,"nodeCards",void 0),n([h(cc.Font)],m.prototype,"fontLuckyDraw",void 0),n([h(sp.SkeletonData)],m.prototype,"luckyDrawWin",void 0),m=n([d],m),i.default=m,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0,"./SixiangAnimWin":"SixiangAnimWin","./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController","./SixiangPresenter":"SixiangPresenter","./SixiangUtils":"SixiangUtils"}],SixiangNetworkTransport:[function(e,t,i){"use strict";cc._RF.push(t,"533efAiW9RGkbtahWrDg5rM","SixiangNetworkTransport"),Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../lobby/src/network/NetworkClient"),a=e("../../lobby/src/common/GlobalApp"),s=e("../../lobby/src/common/Constants"),o=e("../../lobby/src/common/ConfigClient"),l=e("../../lobby/src/chat/ChatPresenter"),c=e("./SixiangController"),r=e("../../lobby/src/lobby/GameList");class d{static subscribe(){n.default.getInstance().subscribeEventHandler(s.Game.Enum.SIXIANG,d)}static matchDataHandler(e){switch(e.op_code){case o.default.Network.OP_CODE.OPCODE_UPDATE_TABLE:cc.log("OPCODE_UPDATE_TABLE",e.data),c.default.getInstance().updateDesk(e.data);break;case o.default.Network.OP_CODE.OPCODE_UPDATE_GAME_STATE:d.processUpdateGameState(e);break;case o.default.Network.OP_CODE.OPCODE_BUY_SIXIANG_GEM:n.default.getInstance().sendMatchState(a.default.getInstance().matchInfo.match_id,o.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_INFO_TABLE,{}).then(()=>{cc.log("sendActionSpin success ")},e=>{cc.log("sendActionSpin err",e)});break;default:cc.log("Data code not found ",e)}}static processUpdateGameState(e){switch(e.data.state){case s.Game.GAME_STATE.PREPARE:cc.log("GAME_STATE.PREPARE",e);break;case s.Game.GAME_STATE.RUN:cc.log("GAME_STATE.RUN",e);break;case s.Game.GAME_STATE.REWARD:cc.log("GAME_STATE.REWARD",e);break;case s.Game.GAME_STATE.FINISH:cc.log("GAME_STATE.FINISH",e);break;default:cc.log("Match state not found ",e)}}static sendBet(e){n.default.getInstance().sendMatchState(a.default.getInstance().matchInfo.match_id,o.default.Network.OP_CODE_REQUEST.OPCODE_BET,e).then(e=>{cc.log("sendBet success ",e)},e=>{cc.log("sendBet err",e)})}static getUsers(){n.default.getInstance().sendMatchState(a.default.getInstance().matchInfo.match_id,o.default.Network.OP_CODE_REQUEST.OPCODE_LIST_USERS,{}).then(()=>{cc.log("list users ")},e=>{cc.log("get list users failed",e)})}static onQuit(e=(()=>{})){n.default.getInstance().leaveMatch(a.default.getInstance().matchInfo.match_id).then(t=>{cc.log("leave match: ",t),l.default.getInstance().leaveChat(),cc.sys.isBrowser&&o.default.AppInfo.WEB_NATIVE?(e(),window.location.href="/"):a.default.getInstance().loadSceneByMainBundle(o.default.AppInfo.SCENE_NAME.GAMELIST,()=>{var t;e(),null===(t=r.default.getInstance())||void 0===t||t.setGameType(s.GameType.Enum.SLOT_GAME),c.default.getInstance().node.destroy()})},e=>{cc.log("err when leave match",e)})}}i.default=d,cc._RF.pop()},{"../../lobby/src/chat/ChatPresenter":void 0,"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/Constants":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/lobby/GameList":void 0,"../../lobby/src/network/NetworkClient":void 0,"./SixiangController":"SixiangController"}],SixiangPickGold:[function(e,t,i){"use strict";cc._RF.push(t,"6898c6XdxlD1bDDWQwoob+g","SixiangPickGold");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/common/Utils"),s=e("./SixiangAnimWin"),o=e("./SixiangConstants"),l=e("./SixiangController"),c=e("./SixiangPresenter"),r=e("./SixiangUtils"),{ccclass:d,property:h}=cc._decorator;let m=class extends cc.Component{constructor(){super(...arguments),this.nodeAddChildGoldPick=null,this.SprGold=null,this.lbGoldPicks=null,this.fontPickMoney=null,this.eatMoney=null,this.tryAgain=null,this.isAllowClick=!0,this.isStart=!1,this.nodeTarget=null}onLoad(){this.isAllowClick=!0,this.isStart=!1}setInfoGoldPick(e){if(this.isStart)return void this.handleGoldPick(e);this.unscheduleAllCallbacks(),this.lbGoldPicks.string=e.numSpinLeft+" the remaining choices";let t=0;this.isAllowClick=!0,cc.tween(this.nodeAddChildGoldPick).repeatForever(cc.tween().delay(.5).call(()=>{this.effectGoldPick(t++),t++}).call(()=>{})).start(),this.scheduleOnce(this.pickRamdom,10),this.isStart=!0}pickRamdom(){if(!this.nodeAddChildGoldPick.children)return;if(!this.isAllowClick)return;let e=this.nodeAddChildGoldPick.children.filter(e=>e.y>-150&&e.y<200&&e!=this.nodeTarget);if(e.length>0){let t=Math.floor(Math.random()*e.length);c.default.sendActionSpinNoBody(o.SiXiangGame.GOLDPICK),this.isAllowClick=!1,this.nodeTarget=e[t],this.scheduleOnce(()=>{this.isAllowClick=!0,this.scheduleOnce(this.pickRamdom,.5)},.5)}else this.scheduleOnce(()=>{this.isAllowClick=!0,this.scheduleOnce(this.pickRamdom,.5)},.5)}createGoldPick(e){let t=new cc.Node("goldPick").addComponent(cc.Sprite);t.spriteFrame=this.SprGold,t.node.angle=r.default.getRanNum(-20,20),t.node.setPosition(cc.v2(r.default.getRanNum(-555,555),r.default.getRanNum(380,500)));let i=t.node.addComponent(cc.Button).getComponent(cc.Button);var n=new cc.Component.EventHandler;return n.target=this.node,n.component="SixiangPickGold",n.handler="onClickPickGold",n.customEventData=""+e,i.clickEvents=[],i.clickEvents.push(n),t.node}effectGoldPick(e){let t=this.createGoldPick(e);this.nodeAddChildGoldPick.addChild(t);let i=t.x,n=0,a=0,s=0,o=0,l=0,c=0;i<0?(n=i+r.default.getRanNum(0,200),a=r.default.getRanNum(200,555),s=r.default.getRanNum(0,200),o=r.default.getRanNum(-200,0),l=r.default.getRanNum(-400,-200),c=r.default.getRanNum(-555,-400)):(n=-r.default.getRanNum(-200,0),a=r.default.getRanNum(-555,-200),s=r.default.getRanNum(-200,0),o=r.default.getRanNum(0,200),l=r.default.getRanNum(200,400),c=r.default.getRanNum(400,555)),cc.tween(t).to(.5,{position:cc.v3(i,300,0)}).to(1,{position:cc.v3(i,150,0)}).to(1,{position:cc.v3(i,0,0)}).to(1,{position:cc.v3(i,-200,0)}).to(1,{position:cc.v3(i,-300,0)}).to(1,{position:cc.v3(i,-400,0)}).call(()=>{t.y<-380&&t.destroy()}).start()}onClickPickGold(e,t){this.isAllowClick&&(this.unschedule(this.pickRamdom),this.scheduleOnce(this.pickRamdom,5),c.default.sendActionSpinNoBody(o.SiXiangGame.GOLDPICK),this.isAllowClick=!1,this.nodeTarget=e.target,this.scheduleOnce(()=>{this.isAllowClick=!0},.5))}handleGoldPick(e){0===Number(e.numSpinLeft)&&this.unscheduleAllCallbacks(),l.default.getInstance().lbAgUser.string=a.default.formatNumber(Number(e.gameReward.balanceChipsWalletAfter)),l.default.getInstance().lbChipWin.string=a.default.formatNumber(Number(e.gameReward.totalChipsWinByGame)),this.lbGoldPicks.string=e.numSpinLeft+" Free spin left",cc.tween(this.node).call(()=>{e.isFinishGame||this.effectClickPickGold(this.nodeTarget,e)}).delay(2).call(()=>{e.isFinishGame&&l.default.getInstance().showAnimTotalWin(Number(e.gameReward.totalChipsWinByGame),Number(e.chipsMcb),t=>{this.scheduleOnce(()=>{this.showPopupFinish(e)},t)})}).delay(l.default.getInstance().timeShowAnimBigWin).start()}effectClickPickGold(e,t){switch(t.coin){case 1:this.tryAgainPickGold(e);break;default:this.eatMoneyPickGold(e,t)}}eatMoneyPickGold(e,t){let i=r.default.createAnim(this.eatMoney);e.addChild(i.node,999),e.getComponent(cc.Sprite).spriteFrame=null,e.getComponent(cc.Button).interactable=!1,i.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.setAnimation(0,"animation",!1);let n=new cc.Node("lbMoney").addComponent(cc.Label);if(n.font=this.fontPickMoney,n.string=a.default.formatMoneyChip(t.gameReward.chipsWin),n.fontSize=40,t.spinSymbols&&0!==t.spinSymbols.length){switch(t.spinSymbols[0].symbol){case o.SiXiangSymbolGoldPick.JP_MINOR:n.string="MINOR";break;case o.SiXiangSymbolGoldPick.JP_MAJOR:n.string="MAJOR";break;case o.SiXiangSymbolGoldPick.JP_MEGA:n.string="MEGA"}e.addChild(n.node,999)}}tryAgainPickGold(e){let t=r.default.createAnim(this.tryAgain);e.addChild(t.node,999),e.getComponent(cc.Sprite).spriteFrame=null,e.getComponent(cc.Button).interactable=!1,t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,"EN"==cc.sys.localStorage.getItem("language_client")?"eng":"cam",!1)}finishGoldPick(){this.isStart=!1,this.node.active=!1,l.default.getInstance().nodeTop.active=!0,l.default.getInstance().nodeMiddle.active=!0,l.default.getInstance().lb_info.node.parent.active=!0}showPopupFinish(e){this.isAllowClick=!1,l.default.getInstance().totalWinMiniGame=e.gameReward.totalChipsWinByGame,l.default.getInstance().agPlayer=e.gameReward.balanceChipsWalletAfter,a.default.runNumber(l.default.getInstance().lbAgUser,Number(e.gameReward.balanceChipsWalletAfter),.8),l.default.getInstance().nodeAnimWin.active=!0,l.default.getInstance().nodeAnimWin.getComponent(s.default).setInfoResult(e.gameReward.totalChipsWinByGame,l.default.getInstance().gameType)}};n([h(cc.Node)],m.prototype,"nodeAddChildGoldPick",void 0),n([h(cc.SpriteFrame)],m.prototype,"SprGold",void 0),n([h(cc.Label)],m.prototype,"lbGoldPicks",void 0),n([h(cc.Font)],m.prototype,"fontPickMoney",void 0),n([h(sp.SkeletonData)],m.prototype,"eatMoney",void 0),n([h(sp.SkeletonData)],m.prototype,"tryAgain",void 0),m=n([d],m),i.default=m,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0,"./SixiangAnimWin":"SixiangAnimWin","./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController","./SixiangPresenter":"SixiangPresenter","./SixiangUtils":"SixiangUtils"}],SixiangPresenter:[function(e,t,i){"use strict";cc._RF.push(t,"b2b17yadEhC3p47z/bZphrU","SixiangPresenter"),Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../lobby/src/network/NetworkClient"),a=e("../../lobby/src/common/ConfigClient"),s=e("../../lobby/src/common/GlobalApp");i.default=class{static sendActionChangeGame(e,t){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,{chips:e,req_spec_game:t}).then(()=>{cc.log("sendActionSpin success ",e)},e=>{cc.log("sendActionSpin err",e)})}static sendActionSpin(e){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,{chips:e}).then(()=>{cc.log("sendActionSpin success ",e)},e=>{cc.log("sendActionSpin err",e)})}static getMatchResult(){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_INFO_TABLE,{}).then(()=>{cc.log("getMatchResult success ")},e=>{cc.log("getMatchResult err",e)})}static buyGem(e){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_BUY_SIXIANG_GEM,{id:e}).then(()=>{cc.log("buyGem success ",e)},e=>{cc.log("buyGem err",e)})}static updateBet(e){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_BET,{chips:e}).then(()=>{cc.log("buyGem success ",e)},e=>{cc.log("buyGem err",e)})}static sendActionSpinNoBody(e){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,{req_spec_game:e}).then(()=>{cc.log("sendActionSpinNoBody success ")},e=>{cc.log("sendActionSpinNoBody err",e)})}static sendSpinWithIndex(e){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,{id:e}).then(()=>{cc.log("sendSpinWithIndex success ",e)},e=>{cc.log("sendSpinWithIndex err",e)})}static sendChooseBonusGame(e,t){n.default.getInstance().sendMatchState(s.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,{id:t}).then(()=>{cc.log("sendChooseBonusGame success ",t)},e=>{cc.log("sendChooseBonusGame err",e)})}},cc._RF.pop()},{"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/network/NetworkClient":void 0}],SixiangRapidPay:[function(e,t,i){"use strict";cc._RF.push(t,"553a2s+p4ZBlLHUz1hx/YY0","SixiangRapidPay");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/common/Utils"),s=e("./SixiangAnimWin"),o=e("./SixiangConstants"),l=e("./SixiangController"),c=e("./SixiangPresenter"),{ccclass:r,property:d}=cc._decorator;let h=class extends cc.Component{constructor(){super(...arguments),this.lbBonus=null,this.lbMoneyWin=null,this.nodeGifts=null,this.nodeAnimEffectRowCurrent=null,this.animOpen=null,this.multiBonus=1,this.rowCurrent=0,this.isAllowClick=!0,this.isStart=!1}onLoad(){this.lbMoneyWin.string=""+a.default.formatNumber(.5*l.default.getInstance().infoData.betLevels[l.default.getInstance().betIndex]),this.multiBonus=1,this.rowCurrent=0,l.default.getInstance().isBonusGame&&(this.multiBonus*=l.default.getInstance().bonusGameMultiplier),this.animOpen.node.active=!1,this.isAllowClick=!0,this.stateAllButton(!0)}onClickSendRapid(e,t){t&&this.isAllowClick&&(this.stateAllButton(!1),c.default.sendSpinWithIndex(parseInt(t)))}handleRapidPay(e){if(!e.spinSymbols||0===e.spinSymbols.length)return;this.isAllowClick=!1;let t=this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children[this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col].children[0].getComponent(sp.Skeleton);l.default.getInstance().isSelectBonusGame=e.isSelectBonusGame;let i=0;1!=e.item&&(i=.5),cc.tween(this.node).delay(.2).call(()=>{let i="animation";switch(Number(e.spinSymbols[0].symbol)){case o.SiXiangSymbolRapidPay.END:i="end";break;case o.SiXiangSymbolRapidPay.X2:i="2x",this.multiBonus*=2;break;case o.SiXiangSymbolRapidPay.X3:i="3x",this.multiBonus*=3;break;case o.SiXiangSymbolRapidPay.X4:i="4x",this.multiBonus*=4}t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.setAnimation(0,i,!1)}).delay(1).call(()=>{if(1==e.item)return;let t=0;switch(e.matrix.rows-e.spinSymbols[0].row-1){case 0:t=1+this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col;break;case 1:t=6+this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col;break;case 2:t=10+this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col;break;case 3:t=14+this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col;break;case 4:t=17+this.nodeGifts.children[e.matrix.rows-e.spinSymbols[0].row-1].children.length-1-e.spinSymbols[0].col}this.animOpen.node.active=!0,this.animOpen.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animOpen.setAnimation(0,""+t,!1),this.lbBonus.string="x"+this.multiBonus,this.lbMoneyWin.string=""+a.default.formatNumber(e.winAmount),l.default.getInstance().lbChipWin.string=a.default.formatNumber(e.winAmount)}).delay(i).call(()=>{for(let t=0;t<e.matrix.spinLists.length;t++){if(e.matrix.spinLists[t].col===e.spinSymbols[0].col||e.matrix.spinLists[t].row!==e.spinSymbols[0].row)continue;if(e.matrix.lists[e.matrix.spinLists[t].index]===o.SiXiangSymbolRapidPay.UNSPECIFIED||e.matrix.lists[e.matrix.spinLists[t].index]===o.SiXiangSymbolRapidPay.LUCKYBOX)continue;let i="animation",n=e.matrix.rows-e.spinSymbols[0].row-1,a=this.nodeGifts.children[n].children.length-1-e.matrix.spinLists[t].col,s=this.nodeGifts.children[n].children[a].children[0].getComponent(sp.Skeleton);switch(Number(e.matrix.lists[t])){case o.SiXiangSymbolRapidPay.END:i="end_black";break;case o.SiXiangSymbolRapidPay.X2:i="2x_black";break;case o.SiXiangSymbolRapidPay.X3:i="3x_black";break;case o.SiXiangSymbolRapidPay.X4:i="4x_black"}s.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),s.setAnimation(0,i,!1)}}).delay(1).call(()=>{e.isFinishGame||this.rowCurrent<=3&&cc.tween(this.nodeAnimEffectRowCurrent).to(.2,{position:cc.v3(0,122*(this.rowCurrent+1)-265,0)},{easing:"signOut"}).start()}).delay(.5).call(()=>{e.isFinishGame?l.default.getInstance().showAnimTotalWin(Number(e.gameReward.totalChipsWinByGame),Number(e.chipsMcb),t=>{this.scheduleOnce(()=>{this.showPopupFinish(e)},t)}):(this.isAllowClick=!0,this.rowCurrent+=1,this.stateAllButton(!0),this.rowCurrent+=1)}).start()}setInfoRapidPay(e){this.unscheduleAllCallbacks(),e.spinSymbols&&e.spinSymbols.length>0?this.rowCurrent=e.matrix.rows-e.spinSymbols[0].row-1:this.rowCurrent=0,this.stateAllButton(!0),cc.tween(this.nodeAnimEffectRowCurrent).to(.2,{position:cc.v3(0,122*this.rowCurrent-265,0)},{easing:"signOut"}).start(),e.spinSymbols&&e.spinSymbols.length>0&&this.handleRapidPay(e)}finishGameRapidPay(){this.isStart=!1,this.multiBonus=1,this.lbBonus.string="x"+this.multiBonus,this.node.active=!1,l.default.getInstance().isFinishAction=!0,this.resetDisplay()}resetDisplay(){this.nodeAnimEffectRowCurrent.setPosition(cc.v2(0,-265)),this.rowCurrent=0;for(let e=0;e<this.nodeGifts.childrenCount;e++)for(let t=0;t<this.nodeGifts.children[e].childrenCount;t++)this.nodeGifts.children[e].children[t].children[0].getComponent(sp.Skeleton).setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.nodeGifts.children[e].children[t].children[0].getComponent(sp.Skeleton).setAnimation(0,"normal",!1),this.nodeGifts.children[e].children[t].getComponent(cc.Button).interactable=!0}stateAllButton(e){for(let t=0;t<this.nodeGifts.childrenCount;t++)for(let i=0;i<this.nodeGifts.children[t].childrenCount;i++)t===this.rowCurrent?this.nodeGifts.children[t].children[i].getComponent(cc.Button).interactable=e:this.nodeGifts.children[t].children[i].getComponent(cc.Button).interactable=!1}showPopupFinish(e){this.isAllowClick=!1,l.default.getInstance().isFinishAction=!0,l.default.getInstance().totalWinMiniGame=e.gameReward.totalChipsWinByGame,l.default.getInstance().agPlayer=e.gameReward.balanceChipsWalletAfter,a.default.runNumber(l.default.getInstance().lbAgUser,e.gameReward.balanceChipsWalletAfter,.8),l.default.getInstance().nodeAnimWin.active=!0,l.default.getInstance().nodeAnimWin.getComponent(s.default).setInfoResult(e.gameReward.totalChipsWinByGame,l.default.getInstance().gameType)}};n([d(cc.Label)],h.prototype,"lbBonus",void 0),n([d(cc.Label)],h.prototype,"lbMoneyWin",void 0),n([d(cc.Node)],h.prototype,"nodeGifts",void 0),n([d(cc.Node)],h.prototype,"nodeAnimEffectRowCurrent",void 0),n([d(sp.Skeleton)],h.prototype,"animOpen",void 0),h=n([r],h),i.default=h,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0,"./SixiangAnimWin":"SixiangAnimWin","./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController","./SixiangPresenter":"SixiangPresenter"}],SixiangRuleDialog:[function(e,t,i){"use strict";cc._RF.push(t,"a42b57CwYRKr7nC92GkNJx/","SixiangRuleDialog");var n,a=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../../bundles/lobby/src/common/BaseDialog"),o=e("../../../bundles/lobby/src/common/GlobalApp"),l=e("../../../bundles/lobby/src/common/ConfigClient"),{ccclass:c,property:r}=cc._decorator;let d=n=class extends s.default{static getInstance(){return this.instance}static show(e){null==this.instance||null==this.instance.node?o.default.getInstance().loadPrefabByBundle(l.default.Bundle.BUNDLE_NAME.SIXIANG,"res/prefabs/SixiangRuleDialog",(t,i)=>{if(null!=t)return void o.default.getInstance().alertDialog.showMessage(t);let a=cc.instantiate(i);a.parent=e,this.instance=a.getComponent(n),this.instance.node.zIndex=1e3,this.instance.show()}):(this.instance.node.zIndex=1e3,this.instance.show())}};d.instance=null,d=n=a([c],d),i.default=d,cc._RF.pop()},{"../../../bundles/lobby/src/common/BaseDialog":void 0,"../../../bundles/lobby/src/common/ConfigClient":void 0,"../../../bundles/lobby/src/common/GlobalApp":void 0}],SixiangScatterSpin:[function(e,t,i){"use strict";cc._RF.push(t,"b7e096Oa6tKeYtebVflj++C","SixiangScatterSpin");var n=this&&this.__decorate||function(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});const a=e("../../lobby/src/common/ConfigClient"),s=e("../../lobby/src/network/NetworkClient"),o=e("../../lobby/src/common/Utils"),l=e("../../lobby/src/common/GlobalApp"),c=e("./SixiangAnimWin"),r=e("./SixiangConstants"),d=e("./SixiangUtils"),h=e("./SixiangPresenter"),m=e("./SixiangController"),{ccclass:u,property:p}=cc._decorator;let g=class extends cc.Component{constructor(){super(...arguments),this.nodeTableScatterSpin=null,this.animBg=null,this.animScatterSpin=null,this.animEffectScatterSpin=null,this.btnScatterSpin=null,this.nodeAni=null,this.screenBonus=null,this.miniGameAmin=[],this.isClickScatterSpin=!1,this.sixiang_symbol_index={}}onLoad(){this.animEffectScatterSpin.node.active=!0,this.isClickScatterSpin=!1,this.sixiang_symbol_index={[r.SiXiangSymbolBonus.DRAGONBALL]:0,[r.SiXiangSymbolBonus.LUCKYDRAW]:1,[r.SiXiangSymbolBonus.GOLDPICK]:2,[r.SiXiangSymbolBonus.RAPIDPAY]:3,[r.SiXiangSymbolBonus.GOLDX10]:4,[r.SiXiangSymbolBonus.GOLDX20]:5,[r.SiXiangSymbolBonus.GOLDX30]:6,[r.SiXiangSymbolBonus.GOLDX50]:7}}initScatterData(){this.isClickScatterSpin=!1,this.scheduleOnce(()=>{this.isClickScatterSpin||this.scatterSpin()},15);let e=[10,20,30,50];for(let t=0;t<this.nodeTableScatterSpin.childrenCount;t++)this.nodeTableScatterSpin.children[t].getComponent(cc.Label).string=o.default.formatNumber(m.default.getInstance().infoData.betLevels[m.default.getInstance().betIndex]*e[t])}scatterSpin(e,t){this.isClickScatterSpin=!0;const i={chips:m.default.getInstance().infoData.betLevels[m.default.getInstance().betIndex]};switch(Number(t)){case 0:i.req_spec_game=r.SiXiangSymbolBonus.DRAGONBALL;break;case 1:i.req_spec_game=r.SiXiangSymbolBonus.LUCKYDRAW;break;case 2:i.req_spec_game=r.SiXiangSymbolBonus.GOLDPICK;break;case 3:i.req_spec_game=r.SiXiangSymbolBonus.RAPIDPAY}s.default.getInstance().sendMatchState(l.default.getInstance().matchInfo.match_id,a.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,i).then(e=>{console.log("sendActionSpin success ",l.default.getInstance().matchInfo.match_id,e,i)},e=>{console.log("sendActionSpin err",e)})}handleData(e){e.isFinishGame&&this.handleScatterSpin(e)}handleScatterSpin(e){this.btnScatterSpin.interactable=!1;let t=0,i=0,n=[];for(let a=0;a<5;a++)n.push(cc.tween(this.nodeTableScatterSpin).by(.5/(1-.18*a),{angle:t-=360}));cc.tween(this.nodeTableScatterSpin).repeat(5,n[i].clone(this.nodeTableScatterSpin).then(cc.tween(this.nodeTableScatterSpin).call(()=>{4==i&&cc.tween(this.nodeTableScatterSpin.parent).to(1,{position:cc.v3(-3,-311,0),scale:1},{easing:"sineIn"}).start(),this.animEffectScatterSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animEffectScatterSpin.setAnimation(0,"light run",!0),i++}))).call(()=>{let t=0;switch(this.sixiang_symbol_index[e.spinSymbols[0].symbol]){case 0:t=7;break;case 1:t=5;break;case 2:t=9;break;case 3:t=11;break;case 4:t=4;break;case 5:t=10;break;case 6:t=8;break;case 7:t=6}cc.tween(this.nodeTableScatterSpin).set({angle:0}).to(1.5,{angle:-45*t}).call(()=>{cc.tween(this.nodeTableScatterSpin.parent).to(1,{position:cc.v3(-3,-53,0),scale:.678},{easing:"sineOut"}).start(),this.btnScatterSpin.interactable=!0,this.animEffectScatterSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animEffectScatterSpin.setAnimation(0,"khung eat",!1),cc.tween(this.animEffectScatterSpin.node).repeat(20,cc.tween().blink(.1,1).delay(.05)).start()}).start(),this.animEffectScatterSpin.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),this.animEffectScatterSpin.setAnimation(0,"dragon normal",!1)}).delay(2).call(()=>{if(this.animEffectScatterSpin.node.active=!1,this.sixiang_symbol_index[e.spinSymbols[0].symbol]>3)m.default.getInstance().showAnimTotalWin(e.gameReward.chipsWin,m.default.getInstance().infoData.betLevels[m.default.getInstance().betIndex],t=>{this.scheduleOnce(()=>{cc.tween(this.node).call(()=>{this.effectFinish()}).delay(2).call(()=>{this.finishScatter(e)}).start()},t)});else{let t="animation",i=null;switch(this.sixiang_symbol_index[e.spinSymbols[0].symbol]){case 0:i=this.miniGameAmin[0],this.scheduleOnce(()=>{h.default.getMatchResult()},8);break;case 1:i=this.miniGameAmin[1],this.scheduleOnce(()=>{h.default.getMatchResult()},8);break;case 2:i=this.miniGameAmin[2],this.scheduleOnce(()=>{h.default.getMatchResult()},8);break;case 3:i=this.miniGameAmin[3],this.scheduleOnce(()=>{h.default.getMatchResult()},8)}if(null!=i){let e=d.default.createAnim(i,cc.v2(0,0));this.nodeAni.addChild(e.node,500),e.node.active=!0,e.premultipliedAlpha=!1,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,t,!1)}this.scheduleOnce(()=>{this.effectFinish()},6)}}).start()}onPopOn(e=255){this.node.active=!0,this.node.scale=.8,this.nodeAni.removeAllChildren(),this.node.stopAllActions(),this.node.runAction(cc.scaleTo(.1,1).easing(cc.easeBackOut()))}onPopOff(e=!1,t=!1){this.node.stopAllActions(),this.node.runAction(cc.scaleTo(.1,.8).easing(cc.easeBackIn())),this.nodeAni.removeAllChildren(),this.scheduleOnce(()=>{this.node.active=!1},.1)}effectFinish(){let e=d.default.createAnim(this.screenBonus,cc.v2(0,0));m.default.getInstance().node.addChild(e.node,500),e.node.active=!0,e.premultipliedAlpha=!1,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,"animation",!1),this.scheduleOnce(()=>{e.node.destroy()},3.5),m.default.getInstance().resetForNextSpin(),m.default.getInstance().sprTitleWin.spriteFrame=m.default.getInstance().listSprTitleWin[1],m.default.getInstance().isFinishAction=!0,this.scheduleOnce(()=>{this.node.scale=0},2)}finishScatter(e){m.default.getInstance().agPlayer=e.gameReward.balanceChipsWalletAfter,m.default.getInstance().totalWinMiniGame=e.gameReward.chipsWin,m.default.getInstance().lbChipWin.string=o.default.formatNumber(e.gameReward.chipsWin),o.default.runNumber(m.default.getInstance().lbAgUser,e.gameReward.balanceChipsWalletAfter,.8),m.default.getInstance().nodeAnimWin.active=!0,m.default.getInstance().nodeAnimWin.getComponent(c.default).setInfoResult(e.gameReward.chipsWin,m.default.getInstance().gameType),m.default.getInstance().isAutoSpin?m.default.getInstance().setStateSpinBtn("autoSpin"):m.default.getInstance().setStateSpinBtn()}};n([p(cc.Node)],g.prototype,"nodeTableScatterSpin",void 0),n([p(sp.Skeleton)],g.prototype,"animBg",void 0),n([p(sp.Skeleton)],g.prototype,"animScatterSpin",void 0),n([p(sp.Skeleton)],g.prototype,"animEffectScatterSpin",void 0),n([p(cc.Button)],g.prototype,"btnScatterSpin",void 0),n([p(cc.Node)],g.prototype,"nodeAni",void 0),n([p(sp.SkeletonData)],g.prototype,"screenBonus",void 0),n([p([sp.SkeletonData])],g.prototype,"miniGameAmin",void 0),g=n([u],g),i.default=g,cc._RF.pop()},{"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/common/Utils":void 0,"../../lobby/src/network/NetworkClient":void 0,"./SixiangAnimWin":"SixiangAnimWin","./SixiangConstants":"SixiangConstants","./SixiangController":"SixiangController","./SixiangPresenter":"SixiangPresenter","./SixiangUtils":"SixiangUtils"}],SixiangUtils:[function(e,t,i){"use strict";cc._RF.push(t,"a1b2cPU5fZ4kKvN7xI0VniQ","SixiangUtils"),Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../lobby/src/common/Utils");class a{static getRanNum(e,t){const i=Math.random()*(t-e)+e;return Math.floor(i)}static createAnim(e,t=cc.v2(0,0)){const i=(new cc.Node).addComponent(sp.Skeleton);return i.skeletonData=e,i.node.setPosition(t),i.premultipliedAlpha=!1,i}static createEffNumRun(e,t,i,n){e.node.active=!0;const s=(i-t)/n;a.effRunNumber(n,e,t,i,s)}static effRunNumber(e,t,i,a,s){let o=s/25;o<0&&(o=1);const l=cc.callFunc(()=>{(i+=o)>=a&&(i=a),t.string=n.default.formatNumber(Math.ceil(i))}),c=cc.callFunc(()=>{i>=a&&t.node.stopActionByTag(0)}),r=cc.repeat(cc.sequence(l,cc.delayTime(.05),c),25*e);r._tag=0,t.node.runAction(r)}}i.default=a,cc._RF.pop()},{"../../lobby/src/common/Utils":void 0}]},{},["SixiangAnimWin","SixiangBuyChipDialog","SixiangConstants","SixiangController","SixiangDragonPearl","SixiangIntro","SixiangItem","SixiangLuckyDraw","SixiangNetworkTransport","SixiangPickGold","SixiangPresenter","SixiangRapidPay","SixiangRuleDialog","SixiangScatterSpin","SixiangUtils"]);