window.__require=function t(i,e,n){function s(a,l){if(!e[a]){if(!i[a]){var h=a.split("/");if(h=h[h.length-1],!i[h]){var c="function"==typeof __require&&__require;if(!l&&c)return c(h,!0);if(o)return o(h,!0);throw new Error("Cannot find module '"+a+"'")}a=h}var r=e[a]={exports:{}};i[a][0].call(r.exports,function(t){return s(i[a][1][t]||t)},r,r.exports,t,i,e,n)}return e[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<n.length;a++)s(n[a]);return s}({TarzanConstants:[function(t,i,e){"use strict";cc._RF.push(i,"29f6d3lLZlF7Jd0yaVHnj0+","TarzanConstants"),Object.defineProperty(e,"__esModule",{value:!0}),e.GAME_CONFIG=e.ZINDEX=void 0,e.ZINDEX={ITEMANIM:30,LINE:10,ANIM_TARZAN:300},e.GAME_CONFIG={RECT_SIZE:cc.v2(160,140),SPEED_NORMAL:.15,SPEED_AUTO:.1},cc._RF.pop()},{}],TarzanController:[function(t,i,e){"use strict";cc._RF.push(i,"19528/JzBRJ26J1f0JIC4vZ","TarzanController");var n,s=this&&this.__decorate||function(t,i,e,n){var s,o=arguments.length,a=o<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,i,e,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(i,e,a):s(i,e))||a);return o>3&&a&&Object.defineProperty(i,e,a),a};Object.defineProperty(e,"__esModule",{value:!0});const o=t("../../lobby/src/language/LanguageController"),a=t("../../lobby/src/common/Utils"),l=t("../../lobby/src/common/Constants"),h=t("../../lobby/src/dialogs/banner/BannerDialog"),c=t("../../lobby/src/common/User"),r=t("../../lobby/src/common/GlobalApp"),p=t("../../lobby/src/dialogs/shop/ShopDialog"),m=t("../../lobby/src/dialogs/option/OptionDialog"),d=t("../../lobby/src/chat/ChatPresenter"),u=t("./TarzanRuleDialog"),g=t("./TarzanPresenter"),f=t("./TarzanNetworkTransport"),S=t("./TarzanConstants"),A=t("./TarzanEnums"),b=t("./TarzanItemAnimation"),I=t("./TarzanItem"),{ccclass:y,property:C}=cc._decorator;let B=n=class extends cc.Component{constructor(){super(...arguments),this.itemAnim=null,this.itemSlot=null,this.listItemMiniResult=[],this.sprItems=[],this.txtWin=[],this.spriteTextJungle=[],this.effectJungle=[],this.itemAnimDatas=[],this.barLoadExp=null,this.spriteExp=null,this.practice=null,this.blackMask=null,this.parentItemNode=null,this.parentItemNodeInstead=null,this.itemMiniResult=null,this.bkgMid=null,this.bkgTop=null,this.bkgBottom=null,this.freeGamePopup=null,this.jungleBar=null,this.bonusGamePopup=null,this.nodeGameBonus=null,this.nodePopupFullExp=null,this.effectBarExp=null,this.animChipWin=null,this.btnSpin=null,this.lbMarkBet=null,this.lbChipWinRound=null,this.lbChip=null,this.lbResult=null,this.lbInfo=null,this.lbDimond=null,this.lbBonusFree=null,this.lbChipBonusExp=null,this.lbFreeSpinLeft=null,this.lbTypeMark=null,this.lbTitleWin=null,this.speedSpinAnim=null,this.freespinAnim=null,this.bigWinAnim=null,this.tarzanDudayAnim=null,this.listItem=[],this.clickSpinCount=0,this.listLineRect=[],this.listPosRect=[],this.listOriginItem=[],this.listCheckStopCol=[!1,!1,!1,!1,!1],this.listColor=["#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE","#920E48","#F277E2","#BC8B15","#AC6456","#E17512","#E8C500","#F0E915","#FD93A1","#C735D4","#FF0C04","#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE","#920E48","#F277E2","#BC8B15","#AC6456","#E17512","#E8C500","#F0E915","#FD93A1","#C735D4","#FF0C04","#69C4C9","#067048","#25A0F0","#6AF28E","#003CC3","#1DC42C","#6C58B1","#97B158","#0F0098","#6700BE"],this.winningLine=[],this.listWinLineNode=[],this.listItemAnim=[],this.listDataAnimLine=[],this.listSpriteId=[],this.listPosItem=[cc.v2(82,202),cc.v2(255,202),cc.v2(428,202),cc.v2(601,202),cc.v2(774,202)],this.listAnimWS=[],this.listAnimBkgFree=[],this.skeData=[],this.listIndexSpr=[],this.listSymbolAdd=[],this.listValueBonusGame=[],this.listCollum=[],this.listCheckClickBonus=[],this.jungleLetter=[4112,4113,4114,4115,4116,4117],this.isClickSpin=!1,this.isHoldSpin=!1,this.isRunJPNum=!1,this.isRunEffPlusMoney=!1,this.isCheckScatterItem3=!1,this.isCheckSpecialWild=!1,this.isCheckExpExist=!1,this.isCheckBonusGame=!1,this.isAllowClickBonus=!1,this.isAutoSpin=!1,this.isHave2Scatter=!1,this.isStop=!0,this.isShowBigWin=!1,this.isShowHugeWin=!1,this.isShowMegaWin=!1,this.isCountFSPAg=!1,this.isWaitingFreeGame=!1,this.canSpin=!1,this.isSpin=!1,this.isFreeSpin=!1,this.isFreeGame=!1,this.isBonusGame=!1,this.isCheckOnlyLineWild=!0,this.isWildWinInLine=!1,this.isSpinFree=!1,this.countSymbolAdd=0,this.indexClickBonus=0,this.speedSpin=S.GAME_CONFIG.SPEED_NORMAL,this.agPlayer=0,this.markIndex=0,this.winType=0,this.firstDelay=2,this.scatterCount=0,this.totalWin=0,this.startNum=0,this.endNum=0,this.deltaNum=0,this.timeShow=0,this.curNum=0,this.curJackPotNum=0,this.jackPotEndNum=0,this.timeHoldSpin=0,this.totalAgFSP=0,this.spinCountCheck=0,this.timeRunSpin=0,this.curChip=0,this.maxExp=0,this.numExp=0,this.timeCheckResultBonus=1,this.clickSpinBonus=0,this.allowSelectBonus=!1,this.selectBonus=null,this.freeSpinLeft=0,this.freeSpinBonus=0,this.totalResultBonus=0,this.indexDataBonus=0,this.countWild=0,this.timeShowBigMega=0,this.idMini=-1,this.posAnimSpeedX=0,this.playerVip=0,this.numPerSec=0,this.firstAnim=null,this.lbMoney=null,this.animBtnSpin=null,this.blackMaskBig=null,this.finishData=null,this.finishView=[],this.finishViewBonus=[],this.listMarkBet=[],this.curMarkBet=0,this.listScatter=[],this.listWild=[],this.listExp=[],this.listSymbol=[],this.initPosItem=null,this.initHeightItem=0,this.resetPosY1=0,this.resetPosY2=0,this.resetPosY3=0,this.isStarted=!1}static getInstance(){return this.instance}update(t){this.isHoldSpin&&(this.timeHoldSpin+=t,this.timeHoldSpin>=1&&this.isStop&&(this.onClickAutoSpin(),this.setStateSpinBtn(),this.isHoldSpin=!1,this.timeHoldSpin=0))}start(){n.instance=this,this.initializeGame(),this.setupEventHandlers(),this.lbTypeMark.string=o.default.getInstance().getString("txt_bet"),this.lbTitleWin.spriteFrame=this.txtWin[0]}initializeGame(){f.default.subscribe(),this.setMatchInfo(),this.initializeProperties(),this.initializeBonusGameEvents(),this.setZIndexes(),this.isStarted=!1,h.default.show(l.Game.Enum.TARZAN),this.initItemSlot(this.getDefaultSlotData())}initializeProperties(){this.initPosItem=cc.v2(this.parentItemNode.width/10,this.parentItemNode.height/2-48),this.animBtnSpin=this.btnSpin.node.getChildByName("ItemAnimation").getComponent(b.default),this.blackMaskBig=this.node.getChildByName("bkg_black"),this.bkgMid.opacity=0,this.bkgBottom.opacity=255,this.bkgTop.opacity=255}setupEventHandlers(){this.btnSpin.node.on("touchstart",t=>{this.btnSpin.node.getBoundingBoxToWorld().contains(t.getLocation())&&(this.timeHoldSpin=0,this.isHoldSpin=!0)}),this.btnSpin.node.on("touchend",t=>{this.isHoldSpin&&(this.btnSpin.node.getBoundingBoxToWorld().contains(t.getLocation())&&(this.isHoldSpin=!1,this.timeHoldSpin<1&&this.onClickSpin()),this.timeHoldSpin=0)})}initializeBonusGameEvents(){this.listCheckClickBonus=new Array(15).fill(!1),this.listValueBonusGame=new Array(15).fill(0);for(let i=0;i<15;i++){let e=this.nodeGameBonus.getChildByName("bonusGameView").children[i].getComponent(cc.Button);var t=new cc.Component.EventHandler;t.target=this.node,t.component="TarzanController",t.handler="onClickWindowBonus",t.customEventData=""+i,e.clickEvents=[],e.clickEvents.push(t)}}setZIndexes(){this.freeGamePopup.parent.zIndex=999,this.bkgTop.zIndex=200,this.bonusGamePopup.zIndex=this.bkgTop.zIndex-1,this.nodeGameBonus.zIndex=this.bonusGamePopup.zIndex-1,this.animChipWin.node.zIndex=this.bkgTop.zIndex+1,this.blackMask.zIndex=S.ZINDEX.LINE}getDefaultSlotData(){return[[{id:3},{id:4},{id:2}],[{id:7},{id:12},{id:7}],[{id:11},{id:5},{id:12}],[{id:0},{id:10},{id:7}],[{id:7},{id:5},{id:6}]]}onClickBack(){m.default.show(this,m.DialogPosition.LEFT)}setMatchInfo(){d.default.getInstance().joinChatRoom(r.default.getInstance().matchInfo.match_id,this)}onQuit(){h.BannerData.setBannerData(l.Banner.ShowType.LEFT_MATCH,!0,l.Game.Enum.TARZAN),f.default.onQuit()}startEffect(){this.bkgTop.stopAllActions(),this.bkgBottom.stopAllActions(),this.bkgMid.stopAllActions(),this.bkgMid.runAction(cc.sequence(cc.fadeTo(.5,255),cc.callFunc(()=>{this.canSpin=!0})))}onClickSpin(t,i){if(!this.isAllowClickBonus&&(this.canSpin||this.isAutoSpin)&&!(this.clickSpinCount>1)&&(this.isStop||!this.isFreeSpin))return(0===this.listMarkBet.length||this.agPlayer<this.listMarkBet[0])&&this.freeSpinLeft<=0?(this.lbInfo.string=o.default.getInstance().getString("not_enought_gold"),void r.default.getInstance().alertDialog.showMessage(o.default.getInstance().getString("txt_not_enough_money_gl"))):this.clickSpinCount>0?(this.isAutoSpin=!1,this.setStateSpinBtn(),void(this.isStop&&this.resetForNextSpin())):void this.processSpin()}processSpin(){this.isSpinFree=this.isFreeSpin,this.node.stopAllActions(),this.turnOffAnim(),this.playSoundEff("clickspin"),this.isFreeSpin?this.freeSpinLeft>0&&(0===this.listAnimBkgFree.length?this.showAnimBkgFreeSpin():this.lbFreeSpinLeft.string=(this.freeSpinLeft-1).toString()):(this.curChip=this.agPlayer,a.default.runNumber(this.lbChip,this.curChip-this.curMarkBet,1),this.agPlayer-=this.curMarkBet,this.curChip=this.agPlayer),this.clickSpinCount++,f.default.sendSpin({chips:this.curMarkBet}),this.isStop=!1,this.setStateSpinBtn(),this.blackMask.active=!1;for(let t=0;t<this.listCheckStopCol.length;t++)this.listCheckStopCol[t]=!1;this.lbInfo.node.active=!0,this.lbInfo.string=o.default.getInstance().getString("txt_playing_lines").replace("%d","100"),this.playSoundEff("wheelspin"),this.startSpinAnimation()}startSpinAnimation(){this.listCollum.forEach((t,i)=>{t.forEach(t=>{let e=t.getComponent(I.default);cc.Tween.stopAllByTarget(t),this.animateColumnItem(e,t,i)})})}animateColumnItem(t,i,e){var n=()=>{t.typeItem--,this.listCheckStopCol[e]||t.numCol!=e?this.listCheckStopCol[e]&&t.numCol==e&&this.stopSpinAnimation(t,i,e):this.continueSpinAnimation(t,i,e,n)};this.startInitialSpin(t,i,n)}continueSpinAnimation(t,i,e,n){t.typeItem<0&&(t.node.position=cc.v2(t.node.position.x,this.resetPosY2),t.typeItem=2,this.isCheckScatterItem3&&t.numCol>3&&t.setRandomId(!1),t.setRandomId(!0));let s=this.speedSpin;3==e&&!this.isAutoSpin&&this.isCheckScatterItem3&&(s=S.GAME_CONFIG.SPEED_NORMAL),cc.tween(t.node).to(s,{y:i.y-this.initHeightItem-50}).call(n).start()}stopSpinAnimation(t,i,e){let n=0;3==e&&this.isCheckScatterItem3&&(n=0),t.typeItem<0&&(t.node.position=cc.v2(t.node.position.x,this.resetPosY2),t.typeItem=2,this.isCheckScatterItem3&&t.numCol>3&&t.setRandomId(!1),t.setSpriteListItem(this.finishView[e],!1),this.listOriginItem.push(i)),0===t.typeItem&&(i.y=this.resetPosY3,t.typeItem=3);let s=this.isAutoSpin?.15:.2;3===e&&this.isCheckScatterItem3&&(this.speedSpin=S.GAME_CONFIG.SPEED_AUTO,n=2,this.setInfoAnim(this.firstAnim,this.speedSpinAnim,cc.v3(this.posAnimSpeedX,0),cc.v2(1,1)),this.firstAnim.node.parent=this.bkgMid,this.firstAnim.node.zIndex=this.parentItemNode.zIndex+1,this.firstAnim.playAnimation2("animation",!0)),t.setSpriteListItem(t.listDataView,!1),cc.tween(i).to(s,{y:i.y-this.initHeightItem-50},{easing:cc.easing.backOut}).delay(this.isAutoSpin&&this.isCheckScatterItem3?n:0).call(()=>{this.playSoundEff("stopspin"),this.canSpin=!1,this.isAutoSpin&&(this.listCheckStopCol[e+1]=!0)}).call(()=>{if(4==e&&2==t.typeItem){for(let t=0;t<this.winningLine.length;t++)this.initLineWin(this.winningLine[t].lineWin,this.winningLine[t].color);this.getOriginItem(),this.acShowWinLine()}t.typeItem--,3==e&&this.isCheckScatterItem3&&(this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null),this.isAutoSpin||(this.listCheckStopCol[e+1]=!0)}).start()}startInitialSpin(t,i,e){cc.tween(i).to(.15,{y:i.y+60},{easing:cc.easing.sineOut}).call(()=>{t.setSpriteListItem(t.listDataView,!0)}).to(this.speedSpin,{y:i.y-this.initHeightItem}).call(e).start()}getRanNum(t,i){let e=Math.random()*(i-t)+t;return Math.floor(e)}playSoundEff(t){}turnOffAnim(){for(let t=0;t<this.listAnimWS.length;t++)this.listAnimWS[t].node.destroy();this.listAnimWS=[];for(let t=0;t<this.listItemAnim.length;t++)this.listItemAnim[t].node.active=!1,this.listItemAnim[t].animation.skeletonData=null}setStateSpinBtn(t=null){let i;switch(this.isStop?i=this.isFreeSpin?"freespinOn":"spinOn":(i=this.isAutoSpin?"autoSpin":"spinOff",i=this.isFreeSpin?"freespinOff":i),null!==t&&(i=t),i){case"spinOn":this.animBtnSpin.playAnimation2("Spin_cam",!0),this.lbFreeSpinLeft.node.active=!1;break;case"spinOff":this.animBtnSpin.node.active=!0,this.animBtnSpin.playAnimation2("Spin_cam",!0),this.lbFreeSpinLeft.node.active=!1;break;case"freespinOn":this.animBtnSpin.node.active=!0,this.animBtnSpin.playAnimation2("Freespin_cam",!0),this.btnSpin.interactable=!0,this.lbFreeSpinLeft.node.active=!0;break;case"freespinOff":this.animBtnSpin.node.active=!0,this.animBtnSpin.playAnimation2("Freespin_cam",!0),this.lbFreeSpinLeft.node.active=!0;break;case"autoSpin":this.animBtnSpin.node.active=!0,this.animBtnSpin.playAnimation2("stop_cam",!0),this.lbFreeSpinLeft.node.active=!1}}updateTable(t){if(this.isStarted){if(t.slotViews=[],t.currentSixiangGame!==A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE)for(let n=0;n<t.matrix.cols;n++){let i=[];for(let e=0;e<t.matrix.lists.length;e++)if(e%t.matrix.cols===n){let n={id:A.Symbol[t.matrix.lists[e]],symbolAdd:-1};if(t.spinSymbols&&t.spinSymbols.length>0)for(let i=0;i<t.spinSymbols.length;i++)t.spinSymbols[i].index===e&&(n.symbolAdd=A.Symbol[t.spinSymbols[i].symbol]-15);i.push(n)}t.slotViews.push(i)}let i={typeBonus:0,numSpin:0},e=t.gameReward.ratioBonus;return t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE&&(i.typeBonus=t.nextSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE&&t.currentSixiangGame!==A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE?2:0,i.numSpin=Number(t.numSpinLeft)),t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9&&(i.typeBonus=t.nextSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9&&t.currentSixiangGame!==A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9?1:0,i.numSpin=Number(t.numSpinLeft)),void this.handleSpin(Object.assign(Object.assign({},t),{currentChipBonus:Number(t.gameReward.perlGreenForestChipsCollect),maxExp:Number(100),numExp:Number(t.gameReward.perlGreenForest),freeSpinLeft:Number(t.numSpinLeft)>0?Number(t.numSpinLeft):0,isFreeSpin:t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9,isBonusGame:t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE,allowSelectBonus:t.nextSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9&&t.currentSixiangGame!==A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9,selectBonus:i,multiFreeGame:e,winType:A.BigWin[t.bigWin],agWin:A.BigWin[t.bigWin]>0?t.gameReward.totalChipsWinByGame:0,chipBonusFullExp:t.gameReward.updateChipsBonus?t.gameReward.perlGreenForestChips:0}))}let i=[];for(let e=0;e<t.matrix.cols;e++){let n=[];for(let i=0;i<t.matrix.lists.length;i++)i%t.matrix.cols===e&&n.push({id:A.Symbol[t.matrix.lists[i]]});i.push(n)}for(let e=0;e<i.length;e++)for(let n=0;n<i[e].length;n++)"object"==typeof i[e][n]&&(-1===i[e][n].id&&(i[e][n].id=this.getRanNum(0,12)),t.freeSpin||this.isFreeGame||(i[e][n].id=this.getRanNum(0,13)));this.isSpin&&this.initItemSlot(i),this.jungleLetter.forEach((i,e)=>{t.letterSymbols.find(t=>t==i)&&(this.jungleLetter[e]=0,this.jungleBar.children[e].children[0].active=!0)}),this.listMarkBet=t.betLevels,this.curMarkBet=Number(t.chipsMcb);for(let e=0;e<t.betLevels.length;e++)if(Number(t.betLevels[e])===Number(t.chipsMcb)){this.markIndex=e;break}this.isFreeSpin=t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9,this.freeSpinLeft=Number(t.numSpinLeft)>0?Number(t.numSpinLeft):0,this.isFreeGame=t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_FREESPINX9,this.isBonusGame=t.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE,this.lbFreeSpinLeft.string=(Number(t.numSpinLeft)>0?Number(t.numSpinLeft):0).toString(),this.lbChipBonusExp.string=a.default.formatNumber(t.gameReward.perlGreenForestChipsCollect),this.freeSpinLeft>0&&0===this.listAnimBkgFree.length&&t.freeSpin&&this.showAnimBkgFreeSpin(),this.setStateSpinBtn(),this.lbChipWinRound.string=t.gameReward.totalChipsWinByGame.toString(),this.agPlayer=Number(t.gameReward.balanceChipsWalletAfter),this.lbMarkBet.string=a.default.formatNumber(this.freeSpinLeft>0?Number(t.chipsMcb):this.curMarkBet),this.lbChip.string=a.default.formatNumber(this.agPlayer),this.playerVip=c.default.vipLevel,this.maxExp=Number(100),this.numExp=Number(t.gameReward.perlGreenForest),this.getBarExp(),this.lbBonusFree.string="x"+t.gameReward.ratioBonus,this.isFreeGame&&(this.lbTitleWin.spriteFrame=this.txtWin[2]),this.isBonusGame&&this.showPopupStartBonusGame(),this.isStarted=!0}initItemSlot(t){let i=0;this.listCollum=[];for(let e=0;e<this.listItem.length;e++)this.listItem[e].destroy();this.listItem=[];for(let e=0;e<15;e++){let n=cc.instantiate(this.itemSlot).getComponent(I.default),s=cc.instantiate(this.itemSlot).getComponent(I.default),o=cc.instantiate(this.itemSlot).getComponent(I.default);if(this.initHeightItem=n.node.height,n.node.position=cc.v3(this.listPosItem[i].x,this.initPosItem.y),this.parentItemNode.addChild(n.node),n.typeItem=1,n.numCol=i,n.setSpriteListItem(t[i]),this.resetPosY1=this.initPosItem.y,4===i){let t=this.parentItemNode.convertToWorldSpaceAR(n.node.position);this.posAnimSpeedX=this.bkgMid.convertToNodeSpaceAR(t).x}s.node.position=cc.v3(n.node.x,n.node.position.y+n.node.height+50),this.parentItemNode.addChild(s.node),s.typeItem=2,s.numCol=i,s.setSpriteListItem(t[i]),this.resetPosY2=s.node.position.y,o.node.position=cc.v3(n.node.x,s.node.position.y+s.node.height+50),this.parentItemNode.addChild(o.node),o.typeItem=3,o.numCol=i,o.setSpriteListItem(t[i]),this.resetPosY3=o.node.position.y;let a=[];a.push(n.node,s.node,o.node),this.listCollum.push(a),this.listItem.push(n.node,s.node,o.node),i++,e+=2}this.startEffect(),this.initItemAnim()}initItemAnim(){for(let t=0;t<5;t++){let t=cc.instantiate(this.itemAnim).getComponent(b.default);this.node.addChild(t.node,S.ZINDEX.ITEMANIM),t.node.active=!1,this.listItemAnim.push(t)}this.firstAnim=cc.instantiate(this.itemAnim).getComponent(b.default),this.node.addChild(this.firstAnim.node,S.ZINDEX.ITEMANIM),this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null}onClickWindowBonus(t,i){this.indexDataBonus=parseInt(i),this.freeSpinBonus--,this.freeSpinBonus<-1||(this.listCheckClickBonus[parseInt(i)]=!0,this.offAllBtnBonus(),this.clickSpinBonus++,this.node.stopAllActions(),this.lbTitleWin.spriteFrame=this.txtWin[1],f.default.sendSpin({chips:this.curMarkBet,id:parseInt(i)}))}handleDataBonus(t,i){if(i<0)return;let e=this.nodeGameBonus.getChildByName("bonusGameView").children[i].getComponent(cc.Button);e.interactable=!1;let n=cc.callFunc(()=>{let i=e.node.children[0].getComponent(sp.Skeleton);i.node.active=!0,i.setAnimation(0,"animation",!1),e.node.children[1].active=!1;let n=e.node.getChildByName("value").getComponent(cc.Label);if(n.node.active=!0,t.spinSymbols[0].symbol===A.Symbol.SI_XIANG_SYMBOL_TARZAN_MORE_TURNX2){n.string="+2 PICKS";let t=this.nodeGameBonus.getChildByName("leftBonus").children[1].getComponent(cc.Label);this.effectFlyMoney(t,2,50,-28,37)}else if(t.spinSymbols[0].symbol===A.Symbol.SI_XIANG_SYMBOL_TARZAN_MORE_TURNX3){n.string="+3 PICKS";let t=this.nodeGameBonus.getChildByName("leftBonus").children[1].getComponent(cc.Label);this.effectFlyMoney(t,3,50,-28,37)}else n.string=a.default.formatMoneyChip(t.spinSymbols[0].winAmount);let s=this.nodeGameBonus.getChildByName("totalWin").children[1].getComponent(cc.Label);this.totalResultBonus=Number(t.gameReward.totalChipsWinByGame),s.string=a.default.formatMoneyChip(this.totalResultBonus),a.default.runNumber(this.lbChip,this.agPlayer,.8)}),s=cc.callFunc(()=>{this.onAllBtnBonus()}),o=cc.callFunc(()=>{this.onAllBtnBonus(),this.finishData.isBonusGame&&0===this.finishData.freeSpinLeft&&this.showPopupEndBonusGame()});this.node.runAction(cc.sequence(n,cc.delayTime(1),o,s,cc.delayTime(s.getDuration())))}onAllBtnBonus(){for(let t=0;t<15;t++)this.listCheckClickBonus[t]||(this.nodeGameBonus.getChildByName("bonusGameView").children[t].getComponent(cc.Button).interactable=!0)}offAllBtnBonus(){for(let t=0;t<15;t++)this.nodeGameBonus.getChildByName("bonusGameView").children[t].getComponent(cc.Button).interactable=!1}onClickAutoSpin(){this.isAutoSpin=!this.isAutoSpin,this.setStateSpinBtn(),this.isStop&&(this.speedSpin=S.GAME_CONFIG.SPEED_AUTO,this.onClickSpin())}handleSpin(t){this.isSpin=!0,this.finishData=t,this.maxExp=t.maxExp,this.numExp=t.numExp,this.isFreeGame=t.freeSpin,this.isBonusGame=t.isBonusGame,this.allowSelectBonus=t.allowSelectBonus,this.selectBonus=t.selectBonus,this.finishView=t.slotViews,this.winType=t.winType,this.freeSpinLeft=t.freeSpinLeft,t.isBonusGame&&(this.finishViewBonus=t.slotViews),this.agPlayer=Number(t.gameReward.balanceChipsWalletAfter),this.totalWin=Number(t.gameReward.totalChipsWinByGame),this.freeSpinLeft=t.freeSpinLeft,(t.freeSpinLeft>0||t.allowSelectBonus)&&!t.isBonusGame?this.isFreeSpin=!0:this.isFreeSpin=!1,this.lbFreeSpinLeft.string=t.freeSpinLeft.toString();let i=0;this.isCheckSpecialWild=!1,this.isCheckExpExist=!1;for(let e=0;e<t.slotViews.length;e++)for(let n=0;n<t.slotViews[e].length;n++)-1===t.slotViews[e][n].id&&(t.slotViews[e][n].id=this.getRanNum(0,12)),12!==t.slotViews[e][n].id||2!=e&&3!=e||i++,13===t.slotViews[e][n].id&&4===e&&(this.isCheckSpecialWild=!0),14===t.slotViews[e][n].id&&(this.isCheckExpExist=!0),-1!==t.slotViews[e][n].symbolAdd&&(this.countSymbolAdd++,this.listSymbolAdd.push(t.slotViews[e][n].symbolAdd));if(t.isBonusGame)for(let e=0;e<this.finishViewBonus.length;e++)for(let t=0;t<this.finishViewBonus[e].length;t++)this.finishViewBonus[e][t].id>=14&&(this.listValueBonusGame[3*e+t]=this.finishViewBonus[e][t].value);this.freeSpinBonus=0,(2===this.selectBonus.typeBonus||t.isBonusGame)&&(this.freeSpinBonus=this.selectBonus.numSpin,this.isFreeSpin=!1,this.nodeGameBonus.getChildByName("leftBonus").children[1].getComponent(cc.Label).string=this.selectBonus.numSpin.toString()),1===this.selectBonus.typeBonus||2===this.selectBonus.typeBonus?this.isAllowClickBonus=!0:this.isAllowClickBonus=!1,this.isCheckScatterItem3=!1,2===i&&(this.isCheckScatterItem3=!0),this.getLineWin(t),setTimeout(()=>{this.node&&!this.isBonusGame&&this.onStopSpin()},500),t.freeSpin&&(this.totalAgFSP=Number(t.gameReward.totalChipsWinByGame)),this.listMarkBet=t.betLevels,this.curMarkBet=Number(t.chipsMcb);for(let e=0;e<t.betLevels.length;e++)if(Number(t.betLevels[e])===Number(t.chipsMcb)){this.markIndex=e;break}this.freeSpinLeft<=0&&(this.lbMarkBet.string=a.default.formatNumber(this.curMarkBet),this.isSpinFree=!1),this.effectBarExp.setAnimation(0,"slow",!0),this.finishData.currentSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE&&this.finishData.spinSymbols.length>0&&this.handleDataBonus(t,this.indexDataBonus),this.isWaitingFreeGame&&(this.showPopupStartFreeGame(),this.isWaitingFreeGame=!1)}showAnimScatter(){this.playSoundEff("wildscatter");for(let t=0;t<this.listScatter.length;t++){let i=this.listScatter[t],e=(new cc.Node).addComponent(sp.Skeleton);e.node.setScale(.5),e.node.position=cc.v3(i.pos),e.skeletonData=this.freespinAnim,e.premultipliedAlpha=!1,e.animation="animation",this.parentItemNodeInstead.addChild(e.node),e.setAnimation(0,"animation",!1)}}showAnimSpecialWild(){this.playSoundEff("wildscatter");for(let t=0;t<this.listWild.length;t++){let i=this.listWild[t];if(13!==i.id)continue;let e=this.getAnimFromPool(this.listAnimWS);this.setInfoAnim(e,this.itemAnimDatas[11],i.pos,cc.v2(.5,.5)),this.node.addChild(e.node),e.playAnimation2("animation",!1)}}showAnimMidWild(){for(let t=0;t<this.listWild.length;t++){let i=this.listWild[t];13!==i.id&&this.showItemAnimMidSymbol(i.id,i.pos,.5)}}setInfoAnim(t,i,e,n,s=!1){null!==t.node&&(t.node.active=!0,t.node.zIndex=S.ZINDEX.ITEMANIM,t.animation.node.setScale(n),t.node.position=e,t.initAnimation(i),t.node.getChildByName("lb_Money").active=s)}showAnimOneWinLine(){if(this.blackMaskBig.active=!1,this.btnSpin.interactable=!this.isAutoSpin,0===this.listWinLineNode.length||this.isAutoSpin&&this.listWinLineNode.length>1)return this.canSpin=!0,this.setStateSpinBtn(),this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.firstAnim.node.getChildByName("lb_Money").active=!1,void(this.agPlayer>=this.listMarkBet[0]||this.finishData.freeSpinLeft>0?this.resetForNextSpin():(this.lbInfo.string=o.default.getInstance().getString("not_enought_gold"),r.default.getInstance().alertDialog.showMessage(o.default.getInstance().getString("txt_not_enough_money_gl"))));if(this.isAutoSpin?this.canSpin=!0:setTimeout(()=>{this.node&&(this.canSpin=!0,this.setStateSpinBtn())},300),this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.firstAnim.node.getChildByName("lb_Money").active=!1,2===this.clickSpinCount)return;let t=this.listWinLineNode.length,i=cc.callFunc(()=>{!this.isAutoSpin&&0===this.finishData.freeSpinLeft||this.finishData.isBonusGame||this.resetForNextSpin()});for(let e=0;e<t;e++)this.node.runAction(cc.sequence(cc.delayTime(1.5*e),cc.callFunc(()=>{for(let e=0;e<this.listWinLineNode.length;e++)this.listWinLineNode[e].node.active=!1;this.playSoundEff("showline"),this.turnOffAnim(),this.turnOffMiniResult();for(let e=0;e<this.listIndexSpr.length;e++)this.listOriginItem[e].getComponent(I.default).setStateSpr(this.listIndexSpr[e],!0);this.listIndexSpr=[];for(let e=0;e<this.listLineRect.length;e++)this.listLineRect[e].active=!1;let t=this.winningLine[e].lineWin;this.listPosRect=[];let i=[],n=[];for(let e=0;e<t.length;e++){let s=this.listOriginItem[e].getComponent(I.default),o=t[e],a=s.getWordPosItem(s.listItem[o]);n.push(a);let l=s.listIdView[o];i.push(l)}this.idMini=-1,this.showListAnim(n,i,this.winningLine[e].color,this.winningLine[e].pays,t)}),cc.delayTime(1.07),i))}showAllWinLine(){if(this.updateMoney(),this.blackMaskBig.active=!1,0!==this.listWinLineNode.length&&(this.blackMask.active=!0),this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.listWinLineNode.length>1)for(let t=0;t<this.listWinLineNode.length;t++)this.node.runAction(cc.sequence(cc.delayTime(S.GAME_CONFIG.SPEED_NORMAL*t),cc.callFunc(()=>{this.listWinLineNode[t].node.active=!0})));this.turnOffAnim(),this.turnOffMiniResult(),this.isStop=!0}showAnimAllWild(){this.playSoundEff("wildscatter");let t=[];for(let i=0;i<this.winningLine.length;i++){let e={lineWinId:[],lineWin:[]},n=this.winningLine[i].lineWinId;n.includes(13)&&(e.lineWinId=n,e.lineWin=this.winningLine[i].lineWin),t.push(e)}for(let i=0;i<t.length;i++){let e=t[i],n=this.checkIndexToShowAnim(e.lineWinId);for(let t=0;t<=n;t++){let i=this.listOriginItem[t].getComponent(I.default);if(13===e.lineWinId[t]){let n=i.getWordPosItem(i.listItem[e.lineWin[t]]),s=this.getAnimFromPool(this.listAnimWS);this.setInfoAnim(s,this.itemAnimDatas[11],n,cc.v2(1,1)),this.node.addChild(s.node,S.ZINDEX.ITEMANIM),s.playAnimation2("animation",!0)}}}}showAnimBigWin(){this.playSoundEff("bigwin"),this.blackMaskBig.active=!0,this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.setInfoAnim(this.firstAnim,this.bigWinAnim,cc.v3(0,0),cc.v2(1,1)),this.firstAnim.node.parent=this.node,this.firstAnim.node.zIndex=1100,this.firstAnim.playAnimation2("big2",!1);let t=this.firstAnim.node.getChildByName("lb_Money");t.active=!0,t.opacity=255,this.lbMoney=t.getComponent(cc.Label),this.lbMoney.fontSize=80,this.lbMoney.node.position=cc.v3(0,-180,0);let i=Number(this.finishData.gameReward.totalChipsWinByGame);this.createEffNumRun(t.getComponent(cc.Label),0,i,this.timeShowBigMega-1),t.runAction(cc.sequence(cc.scaleTo(this.timeShowBigMega-1,1.2),cc.scaleTo(.5,1).easing(cc.easeBackOut()),cc.delayTime(.1),cc.scaleTo(.1,0)))}showAnimHugeWin(){this.playSoundEff("megawin"),this.blackMaskBig.active=!0,this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.setInfoAnim(this.firstAnim,this.bigWinAnim,cc.v3(0,0),cc.v2(1,1)),this.firstAnim.node.parent=this.node,this.firstAnim.node.zIndex=1100,this.firstAnim.playAnimation2("huge2",!1);let t=this.firstAnim.node.getChildByName("lb_Money");t.active=!0,t.opacity=255,this.lbMoney=t.getComponent(cc.Label),this.lbMoney.fontSize=80,this.lbMoney.node.position=cc.v3(0,-180,0);let i=Number(this.finishData.gameReward.totalChipsWinByGame);this.createEffNumRun(t.getComponent(cc.Label),0,i,this.timeShowBigMega-1),t.runAction(cc.sequence(cc.scaleTo(this.timeShowBigMega-1,1.2),cc.scaleTo(.5,1).easing(cc.easeBackOut()),cc.delayTime(.1),cc.scaleTo(.1,0)))}showAnimMegaWin(){this.playSoundEff("megawin"),this.blackMaskBig.active=!0,this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null,this.setInfoAnim(this.firstAnim,this.bigWinAnim,cc.v3(0,0),cc.v2(1,1)),this.firstAnim.node.parent=this.node,this.firstAnim.node.zIndex=1111,this.firstAnim.playAnimation2("mega2",!0);let t=this.firstAnim.node.getChildByName("lb_Money");t.active=!0,t.opacity=255,this.lbMoney=t.getComponent(cc.Label),this.lbMoney.fontSize=80,this.lbMoney.node.position=cc.v3(0,-180,0);let i=Number(this.finishData.gameReward.totalChipsWinByGame);this.createEffNumRun(t.getComponent(cc.Label),0,i,this.timeShowBigMega-1),t.runAction(cc.sequence(cc.scaleTo(this.timeShowBigMega-1,1.2),cc.scaleTo(.5,1).easing(cc.easeBackOut()),cc.delayTime(.1),cc.scaleTo(.1,0)))}showAnimBkgFreeSpin(){this.lbFreeSpinLeft.string=this.freeSpinLeft.toString(),this.lbFreeSpinLeft.node.active=!0}onStopSpin(){this.listOriginItem=[],this.listCheckStopCol[0]=!0}getOriginItem(){this.listScatter=[],this.listWild=[],this.listExp=[],this.listSymbol=[];for(let t=0;t<this.listItem.length;t++){let i=this.listItem[t].getComponent(I.default);i.node.position.y>this.initPosItem.y-100&&i.node.position.y<this.initPosItem.y+10?(i.getScatterItem(),i.getWildItem(),i.getExpItem(),i.getSymbolAddItem()):i.setRandomId(!1)}this.isHave2Scatter=this.scatterCount>1}initLineWin(t,i){let e=[];if(t.length==this.listOriginItem.length){for(let i=0;i<t.length;i++){let n=this.listOriginItem[i].getComponent(I.default),s=n.getWordPosItem(n.listItem[t[i]]);e.push(s)}this.drawLine(e,i)}}getLineWin(t){t.paylines.forEach(i=>{let e={lineWin:[],lineWinId:[],color:null,pays:null},n=i.indices.map(i=>A.Symbol[t.matrix.lists[i]]);e.lineWin=i.indices.map(t=>Math.floor(t/5)),e.color=this.listColor[this.getRanNum(0,this.listColor.length-1)],e.pays=Number(i.chips),e.lineWinId=n,this.winningLine.push(e)})}acShowWinLine(){if(!this.isFreeSpin&&(this.totalAgFSP>=100*this.curMarkBet?this.isShowMegaWin=!0:this.totalAgFSP>=20*this.curMarkBet?this.isShowHugeWin=!0:this.totalAgFSP>=10*this.curMarkBet&&(this.isShowBigWin=!0),this.finishData.freeSpin)){for(let t=0;t<this.listAnimBkgFree.length;t++)this.listAnimBkgFree[t].node.destroy();this.listAnimBkgFree=[]}!this.isFreeSpin&&this.finishData.freeSpin&&(this.totalWin=this.totalAgFSP),this.finishData.nextSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE&&(this.isCheckBonusGame=!0),this.finishData.freeSpin?this.lbChipWinRound.string=a.default.formatNumber(this.totalAgFSP):this.lbChipWinRound.string=a.default.formatNumber(this.totalWin),0===this.finishData.agWin||this.finishData.freeSpin||(this.lbTitleWin.spriteFrame=this.txtWin[0]);let t=0,i=0,e=0,n=(this.listWinLineNode.length,0),s=0,o=0,l=0,h=0,c=0;this.listWinLineNode.length>1&&(l=this.listWinLineNode.length*S.GAME_CONFIG.SPEED_NORMAL+.7),this.isWildWinInLine||this.isHave2Scatter,this.isCheckSpecialWild&&(s=1.2,h=3.5),this.isCheckExpExist&&(o=3),this.listSymbol.length>0&&(c=4),this.isHave2Scatter&&(n=2);let r=[1,101];(r.includes(this.winType)&&!this.finishData.freeSpin||this.isShowBigWin)&&(t=3),((r=[2,102]).includes(this.winType)&&!this.finishData.freeSpin||this.isShowHugeWin)&&(t=0,i=4.5),((r=[3,103]).includes(this.winType)&&!this.finishData.freeSpin||this.isShowMegaWin)&&(t=0,i=0,e=6),this.timeShowBigMega=t+i+e;let p=cc.callFunc(()=>{cc.log("chay vao day!:acShowAllWinLine= "),this.showAllWinLine()}),m=cc.callFunc(()=>{this.node.runAction(cc.callFunc(()=>{this.isBonusGame||this.showAnimOneWinLine()}))}),d=cc.callFunc(()=>{cc.log("allowSelectBonus="+this.finishData.allowSelectBonus),this.isHave2Scatter&&this.showAnimScatter()}),u=cc.callFunc(()=>{this.isCheckSpecialWild&&this.showAnimSpecialWild()}),f=cc.callFunc(()=>{this.isCheckExpExist&&this.showEffectExp()}),b=cc.callFunc(()=>{this.listSymbol.length>0&&this.showEffectTextJungle()}),I=(cc.callFunc(()=>{this.isWildWinInLine&&this.showAnimAllWild()}),cc.callFunc(()=>{([1,101].includes(this.winType)&&!this.finishData.freeSpin||this.isShowBigWin)&&this.showAnimBigWin()})),y=cc.callFunc(()=>{([2,102].includes(this.winType)&&!this.finishData.freeSpin||this.isShowHugeWin)&&this.showAnimHugeWin()}),C=cc.callFunc(()=>{([3,103].includes(this.winType)&&!this.finishData.freeSpin||this.isShowMegaWin)&&this.showAnimMegaWin()}),B=cc.callFunc(()=>{this.isCheckSpecialWild&&this.showAnimTarzanWild()}),E=cc.callFunc(()=>{this.finishData.allowSelectBonus&&(this.isWaitingFreeGame=!0,g.default.getMatchResult())}),N=cc.callFunc(()=>{!this.isFreeSpin&&this.finishData.freeSpin&&this.showPopupEndFreeGame()}),_=cc.callFunc(()=>{this.isCheckBonusGame&&this.showPopupStartBonusGame()}),k=cc.sequence(d,cc.delayTime(n),b,cc.delayTime(c),f,cc.delayTime(o),u,cc.delayTime(s),B,cc.delayTime(h),p,cc.delayTime(l),I,cc.delayTime(t),y,cc.delayTime(i),C,cc.delayTime(e),m,N,E,_);this.node.runAction(k),this.lbInfo.node.active=!1}drawLine(t,i){let e=this.createLine(i);e.moveTo(t[0].x-90,t[0].y),e.lineTo(t[0].x,t[0].y);let n=t.length;for(let s=1;s<n;s++)e.lineJoin=cc.Graphics.LineJoin.ROUND,e.lineTo(t[s].x,t[s].y);e.lineTo(t[n-1].x+90,t[n-1].y),e.stroke(),e.node.active=!1,this.listWinLineNode.push(e)}drawLineLast(t,i){let e=this.createLine(i),n=this.getCrossPoint(t[0],t[1]);"boolean"!=typeof n&&e.moveTo(n.x,n.y);let s=t.length;for(let o=1;o<s;o++)e.lineJoin=cc.Graphics.LineJoin.ROUND,e.lineTo(t[o].x,t[o].y);e.lineTo(t[s-1].x+90,t[s-1].y),e.stroke(),this.listLineRect.push(e.node)}createLine(t,i=!1,e=5){let n=(new cc.Node).addComponent(cc.Graphics);return n.lineWidth=e,n.lineCap=cc.Graphics.LineCap.ROUND,n.strokeColor=(new cc.Color).fromHEX(t),n.node.active=!0,this.node.addChild(n.node,S.ZINDEX.LINE),i&&(n.node.zIndex=S.ZINDEX.ITEMANIM+1),n}showListAnim(t,i,e,n,s){let o=this.checkIndexToShowAnim(i);for(let a=0;a<=o;a++){this.showItemAnim(a,t[a],i[a],n),this.turnOffItemSpr(a,s[a]);let l=t[a],h=o<4&&a===o;if(a+1<=o&&(t[a].y>t[a+1].y+S.GAME_CONFIG.RECT_SIZE.y||t[a].y<t[a+1].y-S.GAME_CONFIG.RECT_SIZE.y)){let i=this.getCrossPoint(t[a],t[a+1]),n=this.getCrossPoint(t[a+1],t[a]),s=this.createLine(e);"boolean"!=typeof i&&s.moveTo(i.x,i.y),"boolean"!=typeof n&&s.lineTo(n.x,n.y),s.stroke(),this.listLineRect.push(s.node)}this.drawRect(l,e,h,o,t)}}checkIndexToShowAnim(t){let i=0,e=t[0];if(this.isCheckOnlyLineWild=!0,this.isCheckSpecialWild)for(let n=1;n<t.length;n++)if((e<4||e>7)&&13!==e&&14!=e){if(this.isCheckOnlyLineWild=!1,!(t[n]===e||13===t[n]||t[n]>=4&&t[n]<=7))break;i++}else{if(12===t[n]||14===t[n])break;i++,((e=t[n])<4||e>7)&&e<12&&(this.isCheckOnlyLineWild=!1)}else{this.isCheckOnlyLineWild=!1;for(let n=1;n<t.length;n++)if(13!==e&&14!=e){if(t[n]!==e&&13!==t[n])break;i++}else{if(12===t[n]||14===t[n])break;e=t[n],i++}}return i}showItemAnim(t,i,e,n){this.setItemMiniResult(e,t,n);let s=this.listItemAnim[t],o="animation";e>=4&&e<=7&&this.isCheckSpecialWild&&(o="wild"),s.initAnimation(this.itemAnimDatas[e]),s.node.position=i,s.node.active=!0,s.animation.node.scale=.5,s.playAnimation2(o,!0)}showItemAnimMidSymbol(t,i,e){let n=(new cc.Node).addComponent(sp.Skeleton);n.node.setScale(e),n.node.position=cc.v3(i),n.skeletonData=this.itemAnimDatas[t],n.premultipliedAlpha=!1,n.animation="wild",this.parentItemNodeInstead.addChild(n.node),n.setAnimation(0,"wild",!1)}showMiniItemAnimMidSymbol(t,i,e,n){let s=(new cc.Node).addComponent(sp.Skeleton);s.node.setScale(e),s.node.position=cc.v3(i),s.skeletonData=this.itemAnimDatas[t],s.premultipliedAlpha=!1,s.animation="wild",n.addChild(s.node),s.setAnimation(0,"wild",!1)}setItemMiniResult(t,i,e){for(let n=0;n<this.listItemMiniResult.length;n++)this.listItemMiniResult[n].node.removeAllChildren();if(this.isCheckSpecialWild){if(13!==t&&(t<4||t>7)){this.idMini=t;for(let e=0;e<i;e++)this.listItemMiniResult[e].spriteFrame=this.sprItems[t]}(13===t||t>=4&&t<=7)&&-1!==this.idMini&&(t=this.idMini),this.isCheckOnlyLineWild&&this.showMiniItemAnimMidSymbol(t,cc.v2(0,0),.15,this.listItemMiniResult[i].node)}else{if(13!==t){this.idMini=t;for(let e=0;e<i;e++)this.listItemMiniResult[e].spriteFrame=this.sprItems[t]}13===t&&-1!==this.idMini&&(t=this.idMini)}this.listItemMiniResult[i].node.active=!0,this.listItemMiniResult[i].spriteFrame=this.sprItems[t],this.lbResult.string=o.default.getInstance().getString("txt_pays_chip").replace("%s",a.default.formatMoney(e)),this.itemMiniResult.active=!0}turnOffMiniResult(){for(let t=0;t<this.listItemMiniResult.length;t++)this.listItemMiniResult[t].node.active=!1}getCrossPoint(t,i){let e=t.y>i.y?-1:1,n=cc.v3(t.x-S.GAME_CONFIG.RECT_SIZE.x,t.y+S.GAME_CONFIG.RECT_SIZE.y/2*e),s=cc.v3(n.x+S.GAME_CONFIG.RECT_SIZE.x,n.y);return Math.abs(t.y-i.y)<1&&(n=cc.v3(t.x+S.GAME_CONFIG.RECT_SIZE.x/2,t.y+S.GAME_CONFIG.RECT_SIZE.y/2),s=cc.v3(t.x+S.GAME_CONFIG.RECT_SIZE.x/2,t.y-S.GAME_CONFIG.RECT_SIZE.y/2)),a.default.getIntersectPoint(n,s,t,i)}turnOffItemSpr(t,i){this.listIndexSpr.push(i),this.listOriginItem[t].getComponent(I.default).setStateSpr(i,!1)}checkWildWinInLine(){let t=[];this.isWildWinInLine=!1;for(let i=0;i<this.winningLine.length;i++){let e=this.winningLine[i].lineWin;for(let i=0;i<e.length;i++)t.push(this.finishView[i][e[i]].id)}this.countWild=this.checkIndexToShowAnim(t);for(let i=0;i<=this.countWild;i++)13===t[i]&&(this.isWildWinInLine=!0)}drawRect(t,i,e,n,s){let o=this.createLine(i,!0,5),a=cc.v2(t.x-S.GAME_CONFIG.RECT_SIZE.x/2,t.y-S.GAME_CONFIG.RECT_SIZE.y/2);if(o.moveTo(a.x,a.y),o.rect(a.x,a.y,S.GAME_CONFIG.RECT_SIZE.x,S.GAME_CONFIG.RECT_SIZE.y),this.listLineRect.push(o.node),o.stroke(),e){let t=s.slice(n,5);t&&t.length>=2?this.drawLineLast(t,i):console.log("listPosLine",s,t,n)}}resetForNextSpin(){if(0!==this.listOriginItem.length)for(let t=0;t<this.listIndexSpr.length;t++)this.listOriginItem[t].getComponent(I.default).setStateSpr(this.listIndexSpr[t],!0);this.listIndexSpr=[],this.parentItemNodeInstead.removeAllChildren(),this.node.stopAllActions(),this.canSpin=!0,this.blackMask.active=!1;for(let t=0;t<this.listWinLineNode.length;t++)this.listWinLineNode[t].node.destroy();this.turnOffAnim();for(let t=0;t<this.listLineRect.length;t++)this.listLineRect[t].destroy();this.listLineRect=[],this.listWinLineNode=[],this.winningLine=[],this.clickSpinCount=0,this.scatterCount=0,this.isShowBigWin=!1,this.isShowHugeWin=!1,this.isShowMegaWin=!1,this.blackMaskBig.active=!1,this.isFreeSpin?(this.finishData.allowSelectBonus&&(this.lbChipWinRound.string="0"),this.lbTitleWin.spriteFrame=this.txtWin[2]):this.lbTitleWin.spriteFrame=this.txtWin[1],this.isFreeSpin||(this.totalAgFSP=0),this.finishData.freeSpin||this.isAutoSpin?this.speedSpin=S.GAME_CONFIG.SPEED_AUTO:this.speedSpin=S.GAME_CONFIG.SPEED_NORMAL,this.setStateSpinBtn(),this.agPlayer<this.listMarkBet[0]&&(this.btnSpin.interactable=!1,this.lbInfo.string=o.default.getInstance().getString("not_enought_gold"),r.default.getInstance().alertDialog.showMessage(o.default.getInstance().getString("txt_not_enough_money_gl"))),this.itemMiniResult.active=!1,this.firstDelay=2,this.lbInfo.node.active=!0,this.agPlayer>=this.listMarkBet[0]||this.freeSpinLeft>0?(this.parentItemNode.getComponent(cc.Button).interactable=!0,this.lbInfo.string=this.isAutoSpin?this.lbInfo.string=o.default.getInstance().getString("txt_playing_lines").replace("%d","100"):o.default.getInstance().getString("txt_press_spin_to_play")):(this.parentItemNode.getComponent(cc.Button).interactable=!1,this.btnSpin.interactable=!1,this.lbInfo.string=o.default.getInstance().getString("not_enought_gold"),r.default.getInstance().alertDialog.showMessage(o.default.getInstance().getString("txt_not_enough_money_gl"))),!this.finishData.isBonusGame&&!this.finishData.freeSpin&&this.finishData.freeSpinLeft>0?this.isAutoSpin=!1:(this.finishData.chipBonusFullExp>0&&(this.isAutoSpin=!1),!this.isAutoSpin&&!this.isSpinFree||this.finishData.isBonusGame||this.finishData.allowSelectBonus||this.finishData.nextSixiangGame===A.SixiangGame.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE||this.onClickSpin())}onClickPlusMarkBet(){!this.isStop||this.isFreeSpin||this.markIndex<0||this.isAutoSpin||(this.markIndex<this.listMarkBet.length-1?(this.markIndex++,this.markIndex===this.listMarkBet.length-1&&(this.lbTypeMark.string=o.default.getInstance().getString("shan2_maxbet"))):(this.markIndex=0,this.lbTypeMark.string=o.default.getInstance().getString("txt_bet")),this.curMarkBet=this.listMarkBet[this.markIndex],this.lbMarkBet.string=a.default.formatNumber(this.curMarkBet))}onClickMinusMarkBet(){!this.isStop||this.isFreeSpin||this.markIndex<0||this.isAutoSpin||(this.markIndex>0?(this.markIndex--,this.lbTypeMark.string=o.default.getInstance().getString("txt_bet")):(this.markIndex=this.listMarkBet.length-1,this.lbTypeMark.string=o.default.getInstance().getString("shan2_maxbet")),this.curMarkBet=this.listMarkBet[this.markIndex],this.lbMarkBet.string=a.default.formatNumber(this.curMarkBet))}onClickMaxBet(){this.agPlayer<this.listMarkBet[0]||!this.isStop||this.isFreeSpin||this.markIndex<0||this.isAutoSpin||(this.lbTypeMark.string=o.default.getInstance().getString("shan2_maxbet"),this.markIndex=this.listMarkBet.length-1,this.curMarkBet=this.listMarkBet[this.markIndex],this.lbMarkBet.string=a.default.formatNumber(this.curMarkBet))}createEffNumRun(t,i,e,n){t.node.active=!0,this.endNum=e,this.deltaNum=this.endNum-this.startNum,this.numPerSec=this.deltaNum/n,this.curNum=i,this.isRunEffPlusMoney=!0,this.effRunNumber(n,t,this.curNum,this.endNum,this.numPerSec)}effRunNumber(t,i,e,n,s){let o=s/20;o<0&&(o=1);let l=cc.callFunc(()=>{(e+=o)>=n&&(e=n),i.string=a.default.formatNumber(Math.ceil(e))}),h=cc.callFunc(()=>{e>=n&&i.node.stopActionByTag(0)}),c=cc.repeat(cc.sequence(l,cc.delayTime(.05),h),20*t);i.node.runAction(c)}updateMoney(){if(0===this.finishData.freeSpinLeft||this.finishData.allowSelectBonus){if(this.curChip===this.agPlayer)this.lbChip.string=a.default.formatNumber(this.agPlayer);else{if(0===Number(this.totalWin))return;this.animChipWin.node.active=!0,this.animChipWin.node.stopAllActions(),this.animChipWin.clearTracks(),this.animChipWin.node.runAction(cc.sequence(cc.callFunc(()=>{this.animChipWin.setAnimation(0,"animation",!1),this.animChipWin.node.active=!0}),cc.delayTime(1),cc.callFunc(()=>{a.default.runNumber(this.lbChip,this.agPlayer,.8)}),cc.delayTime(4),cc.callFunc(()=>{this.animChipWin.node.active=!1})))}0!==this.finishData.agWin&&(this.lbTitleWin.spriteFrame=this.txtWin[0]),this.lbChipWinRound.string=a.default.formatNumber(this.totalWin),this.finishData.allowSelectBonus&&(this.totalAgFSP=0)}}onClickShop(){this.isStop&&p.default.show()}cleanGame(){cc.sys.localStorage.setItem("isBack","false")}onClickRule(){u.default.show(this.node)}getAnimFromPool(t){let i=cc.instantiate(this.itemAnim).getComponent(b.default);return t.push(i),i}showAnimTarzanWild(){let t=cc.callFunc(()=>{this.blackMaskBig.active=!0,this.showAnimTarzanType("du_day")}),i=cc.callFunc(()=>{this.showAnimTarzanType("du_day1")}),e=cc.callFunc(()=>{this.showAnimMidWild()}),n=cc.sequence(t,cc.delayTime(1.5),i,e);this.node.runAction(n)}showAnimTarzanType(t){this.turnOffAnim(),this.firstAnim.node.active=!1,this.firstAnim.animation.skeletonData=null;let i=t;this.setInfoAnim(this.firstAnim,this.tarzanDudayAnim,cc.v3(0,100),cc.v2(.5,.5)),this.firstAnim.node.parent=this.node,this.firstAnim.node.zIndex=S.ZINDEX.ANIM_TARZAN,this.firstAnim.playAnimation2(i,!1)}showEffectExp(){for(let t=0;t<this.listExp.length;t++){let i=this.listExp[t],e=new cc.Node;e.position=cc.v3(i.pos),e.setContentSize(110,90),e.addComponent(cc.Sprite).spriteFrame=this.spriteExp,this.parentItemNodeInstead.addChild(e),this.parentItemNodeInstead.zIndex=this.bkgTop.zIndex+50;let n=cc.v2(-415,315),s=cc.speed(cc.sequence(cc.spawn(cc.moveTo(2,n).easing(cc.easeCubicActionInOut()),cc.scaleTo(2,.6,.6)),cc.callFunc(()=>{this.getBarExp(),this.effectBarExp.setAnimation(0,"quick",!1)}),cc.callFunc(()=>{this.lbDimond.string=this.numExp.toString(),this.lbChipBonusExp.string=a.default.formatNumber(this.finishData.currentChipBonus),this.finishData.chipBonusFullExp>0&&(this.effectFlyMoney(this.lbChipBonusExp,this.finishData.chipBonusFullExp,60,this.lbChipBonusExp.node.x,this.lbChipBonusExp.node.y),a.default.runNumber(this.lbChip,this.agPlayer,.8))}),cc.delayTime(.5),cc.callFunc(()=>{this.parentItemNodeInstead.zIndex=S.ZINDEX.LINE-5,this.finishData.chipBonusFullExp>0&&this.congratulationFullExp()})),2);e.runAction(s)}}congratulationFullExp(){this.nodePopupFullExp.active=!0,this.nodePopupFullExp.getChildByName("popup").getComponent(sp.Skeleton).setAnimation(0,"getgem2",!1),this.nodePopupFullExp.getChildByName("lb_exp_win").getComponent(cc.Label).string=a.default.formatMoneyChip(this.finishData.chipBonusFullExp),this.nodePopupFullExp.getChildByName("btn_start").children[0].active=!0}setTimeout(t,i){setTimeout(()=>{null!=this.node&&t.call(this)},i)}showEffectTextJungle(){let t=this.listSymbol[0],i=new cc.Node,e=(new cc.Node).addComponent(sp.Skeleton);i.position=cc.v3(t.pos),i.addChild(e.node),e.skeletonData=this.effectJungle[t.symbolAdd],e.node.active=!1,e.node.setScale(.5),e.timeScale=.6,e.premultipliedAlpha=!1,this.parentItemNodeInstead.zIndex=this.bkgTop.zIndex+50,this.parentItemNodeInstead.addChild(i);let n=this.parentItemNodeInstead.convertToNodeSpaceAR(this.jungleBar.convertToWorldSpaceAR(cc.v3(this.jungleBar.children[t.symbolAdd].position))),s=cc.speed(cc.sequence(cc.delayTime(.5),cc.callFunc(()=>{e.node.active=!0,e.setAnimation(0,"animation",!1),this.setTimeout(()=>{e.node.active=!1,i.addComponent(cc.Sprite).spriteFrame=this.spriteTextJungle[t.symbolAdd],i.setScale(3)},1500)}),cc.delayTime(2.5),cc.spawn(cc.moveTo(2,cc.v2(n)).easing(cc.easeCubicActionInOut()),cc.scaleTo(2,1,1)),cc.delayTime(.5),cc.callFunc(()=>{for(let t=0;t<this.listSymbolAdd.length;t++)this.jungleBar.children[this.listSymbolAdd[t]].children[0].active=!0;i.setScale(1.3),this.setTimeout(()=>{i.setScale(1)},500)}),cc.delayTime(2.5),cc.callFunc(()=>{i.destroy(),this.parentItemNodeInstead.zIndex=S.ZINDEX.LINE-5})),1.5);i.runAction(s)}getBarExp(){this.numExp>this.maxExp||(this.numExp>0?this.practice.active=!0:this.practice.active=!1,this.lbDimond.string=this.numExp.toString(),this.barLoadExp.fillRange=this.numExp/100,this.practice.x=2.35*this.numExp-118)}showPopupStartFreeGame(){this.freeGamePopup.active=!0;let t=this.freeGamePopup.getChildByName("popup").getComponent(sp.Skeleton);t.setAnimation(0,"yahoo2",!1),t.node.children[0].active=!1,this.freeGamePopup.getChildByName("btn_start").children[0].getComponent(sp.Skeleton).animation="start",this.freeGamePopup.getChildByName("totalwin").getComponent(cc.Label).string=this.finishData.freeSpinLeft.toString();for(let i=0;i<40;i++)this.freeGamePopup.runAction(cc.sequence(cc.delayTime(.1*i),cc.callFunc(()=>{39===i?(this.lbBonusFree.string="x"+this.finishData.multiFreeGame,this.lbBonusFree.node.setScale(1.3),this.setTimeout(()=>{this.lbBonusFree.node.setScale(1),this.freeGamePopup.getChildByName("btn_start").getComponent(cc.Button).interactable=!0},500)):(this.freeGamePopup.getChildByName("btn_start").getComponent(cc.Button).interactable=!1,this.lbBonusFree.string="x"+this.getRanNum(1,10))})))}showPopupEndFreeGame(){this.isAutoSpin=!1,this.freeGamePopup.active=!0;let t=this.freeGamePopup.getChildByName("popup").getComponent(sp.Skeleton);t.setAnimation(0,"wonderful2",!1),t.node.children[0].active=!0,this.freeGamePopup.getChildByName("btn_start").children[0].getComponent(sp.Skeleton).animation="backtogame",this.freeGamePopup.getChildByName("totalwin").getComponent(cc.Label).string=a.default.formatNumber(this.totalWin)}onClickBackFreeGame(){this.isAllowClickBonus=!1,this.freeGamePopup.active=!1}onClickBackBonusGame(){this.isAllowClickBonus=!1,this.bonusGamePopup.active=!1,this.bonusGamePopup.zIndex=this.bkgTop.zIndex-1,g.default.getMatchResult()}onClickBackPopupFullExp(){this.nodePopupFullExp.active=!1}showPopupStartBonusGame(){this.isCheckBonusGame=!1,this.bonusGamePopup.active=!0,this.nodeGameBonus.active=!0;let t=this.bonusGamePopup.getChildByName("startBonusGame").getComponent(sp.Skeleton),i=this.bonusGamePopup.getChildByName("endBonusGame").getComponent(sp.Skeleton),e=this.bonusGamePopup.getChildByName("btn_start").children[0].getComponent(sp.Skeleton);t.node.active=!0,i.node.active=!1,t.setAnimation(0,"Eng",!1),e.animation="start"}showPopupEndBonusGame(){this.bonusGamePopup.zIndex=this.bkgTop.zIndex+2,this.nodeGameBonus.active=!1,this.bonusGamePopup.active=!0;let t=this.bonusGamePopup.getChildByName("startBonusGame").getComponent(sp.Skeleton),i=this.bonusGamePopup.getChildByName("endBonusGame").getComponent(sp.Skeleton),e=this.bonusGamePopup.getChildByName("btn_start").children[0].getComponent(sp.Skeleton);t.node.active=!1,i.node.active=!0,i.node.getChildByName("lb_total").getComponent(cc.Label).string=a.default.formatMoneyChip(this.totalResultBonus),i.setAnimation(0,"Eng",!1),e.animation="backtogame",this.resetTextJungle(),this.resetBonusGame()}resetTextJungle(){this.listSymbolAdd=[],this.countSymbolAdd=0;for(let t=0;t<6;t++)this.jungleBar.children[t].children[0].active=!1}resetBonusGame(){this.listCheckClickBonus=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],this.totalResultBonus=0;for(let t=0;t<15;t++){let i=this.nodeGameBonus.getChildByName("bonusGameView").children[t].getComponent(cc.Button),e=i.node.children[0].getComponent(sp.Skeleton);e.node.active=!0,e.setAnimation(0,"animation",!1),i.interactable=!0,i.node.children[1].active=!0,i.node.getChildByName("value").getComponent(cc.Label).node.active=!1,this.listValueBonusGame[t]=0}this.nodeGameBonus.getChildByName("totalWin").children[1].getComponent(cc.Label).string="0"}effectFlyMoney(t,i,e=50,n=0,s=0){if("number"!=typeof i||0==i)return;if(null==t.node)return;let o=cc.instantiate(t.node),l="";l=i>=0?"+":"",o.getComponent(cc.Label).string=l+a.default.formatNumber(i),o.position=cc.v3(n,s),t.node.parent.addChild(o,999);var h=cc.moveBy(4,cc.v2(0,e)),c=cc.delayTime(h.getDuration()-.5),r=cc.fadeOut(h.getDuration()-c.getDuration()),p=cc.spawn(h,cc.sequence(c,r)),m=cc.sequence(p,cc.callFunc(()=>{null!==o&&o.destroy()}));o.runAction(m)}};B.instance=null,s([C(cc.Prefab)],B.prototype,"itemAnim",void 0),s([C(cc.Prefab)],B.prototype,"itemSlot",void 0),s([C([cc.Sprite])],B.prototype,"listItemMiniResult",void 0),s([C([cc.SpriteFrame])],B.prototype,"sprItems",void 0),s([C([cc.SpriteFrame])],B.prototype,"txtWin",void 0),s([C([cc.SpriteFrame])],B.prototype,"spriteTextJungle",void 0),s([C([sp.SkeletonData])],B.prototype,"effectJungle",void 0),s([C([sp.SkeletonData])],B.prototype,"itemAnimDatas",void 0),s([C(cc.Sprite)],B.prototype,"barLoadExp",void 0),s([C(cc.SpriteFrame)],B.prototype,"spriteExp",void 0),s([C(cc.Node)],B.prototype,"practice",void 0),s([C(cc.Node)],B.prototype,"blackMask",void 0),s([C(cc.Node)],B.prototype,"parentItemNode",void 0),s([C(cc.Node)],B.prototype,"parentItemNodeInstead",void 0),s([C(cc.Node)],B.prototype,"itemMiniResult",void 0),s([C(cc.Node)],B.prototype,"bkgMid",void 0),s([C(cc.Node)],B.prototype,"bkgTop",void 0),s([C(cc.Node)],B.prototype,"bkgBottom",void 0),s([C(cc.Node)],B.prototype,"freeGamePopup",void 0),s([C(cc.Node)],B.prototype,"jungleBar",void 0),s([C(cc.Node)],B.prototype,"bonusGamePopup",void 0),s([C(cc.Node)],B.prototype,"nodeGameBonus",void 0),s([C(cc.Node)],B.prototype,"nodePopupFullExp",void 0),s([C(sp.Skeleton)],B.prototype,"effectBarExp",void 0),s([C(sp.Skeleton)],B.prototype,"animChipWin",void 0),s([C(cc.Button)],B.prototype,"btnSpin",void 0),s([C(cc.Label)],B.prototype,"lbMarkBet",void 0),s([C(cc.Label)],B.prototype,"lbChipWinRound",void 0),s([C(cc.Label)],B.prototype,"lbChip",void 0),s([C(cc.Label)],B.prototype,"lbResult",void 0),s([C(cc.Label)],B.prototype,"lbInfo",void 0),s([C(cc.Label)],B.prototype,"lbDimond",void 0),s([C(cc.Label)],B.prototype,"lbBonusFree",void 0),s([C(cc.Label)],B.prototype,"lbChipBonusExp",void 0),s([C(cc.Label)],B.prototype,"lbFreeSpinLeft",void 0),s([C(cc.Label)],B.prototype,"lbTypeMark",void 0),s([C(cc.Sprite)],B.prototype,"lbTitleWin",void 0),s([C(sp.SkeletonData)],B.prototype,"speedSpinAnim",void 0),s([C(sp.SkeletonData)],B.prototype,"freespinAnim",void 0),s([C(sp.SkeletonData)],B.prototype,"bigWinAnim",void 0),s([C(sp.SkeletonData)],B.prototype,"tarzanDudayAnim",void 0),B=n=s([y],B),e.default=B,cc._RF.pop()},{"../../lobby/src/chat/ChatPresenter":void 0,"../../lobby/src/common/Constants":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/common/User":void 0,"../../lobby/src/common/Utils":void 0,"../../lobby/src/dialogs/banner/BannerDialog":void 0,"../../lobby/src/dialogs/option/OptionDialog":void 0,"../../lobby/src/dialogs/shop/ShopDialog":void 0,"../../lobby/src/language/LanguageController":void 0,"./TarzanConstants":"TarzanConstants","./TarzanEnums":"TarzanEnums","./TarzanItem":"TarzanItem","./TarzanItemAnimation":"TarzanItemAnimation","./TarzanNetworkTransport":"TarzanNetworkTransport","./TarzanPresenter":"TarzanPresenter","./TarzanRuleDialog":"TarzanRuleDialog"}],TarzanEnums:[function(t,i,e){"use strict";cc._RF.push(i,"34c35aN70FPA5CUkFhbjgTY","TarzanEnums"),Object.defineProperty(e,"__esModule",{value:!0}),e.BigWin=e.SixiangGame=e.Symbol=void 0,e.Symbol={2:2,4:1,8:0,16:3,4097:7,4098:6,4099:5,4100:4,4101:10,4102:9,4103:8,4104:12,4105:13,4118:14,4112:15,4113:16,4114:17,4115:18,4116:19,4117:20,SI_XIANG_SYMBOL_TARZAN_MORE_TURNX2:4128,SI_XIANG_SYMBOL_TARZAN_MORE_TURNX3:4129,SI_XIANG_SYMBOL_TARZAN_RANDOM_1:4130,SI_XIANG_SYMBOL_TARZAN_RANDOM_2:4131,SI_XIANG_SYMBOL_TARZAN_RANDOM_3:4132,SI_XIANG_SYMBOL_TARZAN_RANDOM_4:4133,SI_XIANG_SYMBOL_TARZAN_RANDOM_5:4134},function(t){t[t.SI_XIANG_GAME_NORMAL=1]="SI_XIANG_GAME_NORMAL",t[t.SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE=101]="SI_XIANG_GAME_TARZAN_JUNGLE_TREASURE",t[t.SI_XIANG_GAME_TARZAN_FREESPINX9=102]="SI_XIANG_GAME_TARZAN_FREESPINX9"}(e.SixiangGame||(e.SixiangGame={})),e.BigWin={0:0,5:0,10:2,25:1,50:3},cc._RF.pop()},{}],TarzanInterfaces:[function(t,i,e){"use strict";cc._RF.push(i,"a4e9ealL1ZD2ZLDArQyCcTJ","TarzanInterfaces"),Object.defineProperty(e,"__esModule",{value:!0}),cc._RF.pop()},{}],TarzanItemAnimation:[function(t,i,e){"use strict";cc._RF.push(i,"3777duYmo9GJ7oAV/mWePvJ","TarzanItemAnimation");var n=this&&this.__decorate||function(t,i,e,n){var s,o=arguments.length,a=o<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,i,e,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(i,e,a):s(i,e))||a);return o>3&&a&&Object.defineProperty(i,e,a),a};Object.defineProperty(e,"__esModule",{value:!0});const{ccclass:s,property:o}=cc._decorator;let a=class extends cc.Component{constructor(){super(...arguments),this.animation=null}initAnimation(t){this.animation.skeletonData=t,this.animation.premultipliedAlpha=!1,this.animation.animation="animation"}playAnimation(t="animation",i=!1,e=!0,n=!1){this.animation.node.active=!0,this.animation.paused=!1,this.animation.setAnimation(0,t,i),n||this.animation.node.runAction(cc.sequence(cc.delayTime(3.5),cc.removeSelf()))}playAnimation2(t="animation",i=!1){this.animation.node.active=!0,this.animation.paused=!1,this.animation.setAnimation(0,t,i)}playAnimBinh(t="animation",i=!1){this.animation.node.opacity=255,this.animation.setAnimation(0,t,i)}setMultiAlpha(t){this.animation.premultipliedAlpha=t}stopAnimation(){this.animation.node.active=!1,this.animation.paused=!0}};n([o(sp.Skeleton)],a.prototype,"animation",void 0),a=n([s],a),e.default=a,cc._RF.pop()},{}],TarzanItem:[function(t,i,e){"use strict";cc._RF.push(i,"0c7baU/jSZGeJ67zhKFEqwH","TarzanItem");var n=this&&this.__decorate||function(t,i,e,n){var s,o=arguments.length,a=o<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,i,e,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(i,e,a):s(i,e))||a);return o>3&&a&&Object.defineProperty(i,e,a),a};Object.defineProperty(e,"__esModule",{value:!0});const s=t("./TarzanController"),{ccclass:o,property:a}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.frameItems=[],this.frameBlurs=[],this.listItem=[],this.itemMain=[],this.itemBlur=[],this.numCol=null,this.typeItem=null,this.listDataView=[],this.listIdView=[]}getRanNum(t,i){const e=Math.random()*(i-t)+t;return Math.floor(e)}setRandomId(t){const i=[{id:this.getRanNum(0,12),value:0,symbolAdd:-1,wildFake:!1},{id:this.getRanNum(0,12),value:0,symbolAdd:-1,wildFake:!1},{id:this.getRanNum(0,12),value:0,symbolAdd:-1,wildFake:!1}];this.setSpriteListItem(i,t)}setSpriteListItem(t,i=!1){const e=[],n=[];for(let s=0;s<this.listItem.length;s++){const i=t[s].id;t[s].value,this.setSprSonItem(s,i),e.push(t[s].id),n.push(t[s].value)}this.listDataView=t.slice(),this.listIdView=e.slice()}setSprSonItem(t,i){const e=this.itemBlur[t],n=this.itemMain[t];switch(e.getComponent(cc.Sprite).spriteFrame=this.frameBlurs[i],n.getComponent(cc.Sprite).spriteFrame=this.frameItems[i],i){case 0:n.setContentSize(cc.size(116,156));break;case 1:n.setContentSize(cc.size(128,130.4));break;case 2:n.setContentSize(cc.size(108.8,134.4));break;case 3:n.setContentSize(cc.size(99.2,115.2));break;case 4:n.setContentSize(cc.size(148,144));break;case 5:n.setContentSize(cc.size(167,132));break;case 6:n.setContentSize(cc.size(159,138));break;case 7:n.setContentSize(cc.size(146,142));break;case 8:n.setContentSize(cc.size(166,148));break;case 9:case 10:n.setContentSize(cc.size(168,155));break;case 11:n.setContentSize(cc.size(110,90));break;case 12:n.setContentSize(cc.size(169,148));break;case 13:n.setContentSize(cc.size(168,185));break;case 14:n.setContentSize(cc.size(110,90));break;default:n.setContentSize(cc.size(139,144))}}getWordPosItemList(){const t=[];for(let i=0;i<this.listItem.length;i++){const e=this.getWordPosItem(this.listItem[i]);t.push(e)}return t}getWordPosItem(t){const i=this.node.convertToWorldSpaceAR(t.position);return s.default.getInstance().node.convertToNodeSpaceAR(i)}getScatterItem(){for(let t=0;t<this.listIdView.length;t++){const i=this.listIdView[t];if(12===i){const e={pos:this.getWordPosItem(this.listItem[t]),id:i};s.default.getInstance().scatterCount++,s.default.getInstance().listScatter.push(e)}}}getWildItem(){for(let t=0;t<this.listIdView.length;t++){const i=this.listIdView[t];if(i>=4&&i<=7||13===i){const e={pos:this.getWordPosItem(this.listItem[t]),id:i};s.default.getInstance().listWild.push(e)}}}getExpItem(){for(let t=0;t<this.listIdView.length;t++){const i=this.listIdView[t];if(14===i){const e={pos:this.getWordPosItem(this.listItem[t]),id:i};s.default.getInstance().listExp.push(e)}}}getSymbolAddItem(){for(let t=0;t<this.listDataView.length;t++)if(this.listDataView[t].symbolAdd>-1){const i={pos:this.getWordPosItem(this.listItem[t]),symbolAdd:this.listDataView[t].symbolAdd};s.default.getInstance().listSymbol.push(i)}}getItemWithId(t){const i=[];for(let e=0;e<this.listIdView.length;e++)this.listIdView[e]===t&&i.push(this.listItem[e]);return i}setStateSpr(t,i){this.itemMain[t].active=i}};n([a([cc.SpriteFrame])],l.prototype,"frameItems",void 0),n([a([cc.SpriteFrame])],l.prototype,"frameBlurs",void 0),n([a([cc.Node])],l.prototype,"listItem",void 0),n([a([cc.Node])],l.prototype,"itemMain",void 0),n([a([cc.Node])],l.prototype,"itemBlur",void 0),l=n([o],l),e.default=l,cc._RF.pop()},{"./TarzanController":"TarzanController"}],TarzanNetworkTransport:[function(t,i,e){"use strict";cc._RF.push(i,"e5334T633BDEZb3yU4i6a0A","TarzanNetworkTransport"),Object.defineProperty(e,"__esModule",{value:!0});const n=t("../../lobby/src/common/ConfigClient"),s=t("../../lobby/src/network/NetworkClient"),o=t("../../lobby/src/common/Constants"),a=t("../../lobby/src/common/GlobalApp"),l=t("../../lobby/src/chat/ChatPresenter"),h=t("./TarzanController"),c=t("../../lobby/src/lobby/GameList");class r{static subscribe(){s.default.getInstance().subscribeEventHandler(o.Game.Enum.TARZAN,r)}static matchDataHandler(t){switch(t.op_code){case n.default.Network.OP_CODE.OPCODE_UPDATE_TABLE:cc.log("OPCODE_UPDATE_TABLE",t.data),h.default.getInstance().updateTable(t.data);break;case n.default.Network.OP_CODE.OPCODE_UPDATE_DEAL:cc.log("OPCODE_UPDATE_DEAL",t.data);break;case n.default.Network.OP_CODE.OPCODE_UPDATE_GAME_STATE:r.processUpdateGameState(t);break;case n.default.Network.OP_CODE.OPCODE_UPDATE_FINISH:cc.log("result",t);break;case n.default.Network.OP_CODE.OPCODE_UPDATE_WALLET:cc.log("wallet",t);break;case n.default.Network.OP_CODE.OPCODE_KICK_OFF_THE_TABLE:cc.log("kick off",t),r.onQuit();break;default:cc.log("Data code not found ",t)}}static processUpdateGameState(t){switch(t.data.state){case o.Game.GAME_STATE.PREPARE:break;case o.Game.GAME_STATE.RUN:cc.log("GAME_STATE.RUN",t);break;case o.Game.GAME_STATE.REWARD:cc.log("GAME_STATE.REWARD",t);break;case o.Game.GAME_STATE.FINISH:cc.log("GAME_STATE.FINISH",t);break;default:cc.log("Match state not found ",t)}}static sendSpin(t){const i=a.default.getInstance().matchInfo;i&&i.match_id?s.default.getInstance().sendMatchState(i.match_id,n.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_SPIN,t).then(t=>{cc.log("sendSpin success ",t)}).catch(t=>{cc.log("sendSpin err",t)}):cc.error("Match info or match_id not available")}static onQuit(t=(()=>{})){const i=a.default.getInstance().matchInfo;i&&i.match_id?s.default.getInstance().leaveMatch(i.match_id).then(i=>{cc.log("leave match: ",i),l.default.getInstance().leaveChat(),cc.sys.isBrowser&&n.default.AppInfo.WEB_NATIVE?(t(),window.location.href="/"):a.default.getInstance().loadSceneByMainBundle(n.default.AppInfo.SCENE_NAME.GAMELIST,()=>{var i;t(),null===(i=c.default.getInstance())||void 0===i||i.setGameType(o.GameType.Enum.SLOT_GAME),h.default.getInstance().node.destroy()})}).catch(t=>{cc.log("err when leave match",t)}):cc.error("Match info or match_id not available")}}e.default=r,cc._RF.pop()},{"../../lobby/src/chat/ChatPresenter":void 0,"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/Constants":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/lobby/GameList":void 0,"../../lobby/src/network/NetworkClient":void 0,"./TarzanController":"TarzanController"}],TarzanPresenter:[function(t,i,e){"use strict";cc._RF.push(i,"e06d5kZtXFNq4cybNqKX1SR","TarzanPresenter"),Object.defineProperty(e,"__esModule",{value:!0});const n=t("../../lobby/src/network/NetworkClient"),s=t("../../lobby/src/common/ConfigClient"),o=t("../../lobby/src/common/GlobalApp");e.default=class{static getMatchResult(){const t=o.default.getInstance().matchInfo;t&&t.match_id?n.default.getInstance().sendMatchState(t.match_id,s.default.Network.OP_CODE_REQUEST.OPCODE_REQUEST_INFO_TABLE,{}).then(t=>{cc.log("getMatchResult success ",t)}).catch(t=>{cc.log("getMatchResult err",t)}):cc.log("Match info or match_id not available")}},cc._RF.pop()},{"../../lobby/src/common/ConfigClient":void 0,"../../lobby/src/common/GlobalApp":void 0,"../../lobby/src/network/NetworkClient":void 0}],TarzanRuleDialog:[function(t,i,e){"use strict";cc._RF.push(i,"3b610JoQ+hKjLWzo9hdM1nI","TarzanRuleDialog");var n,s=this&&this.__decorate||function(t,i,e,n){var s,o=arguments.length,a=o<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,i,e,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(i,e,a):s(i,e))||a);return o>3&&a&&Object.defineProperty(i,e,a),a};Object.defineProperty(e,"__esModule",{value:!0});const o=t("../../../bundles/lobby/src/common/BaseDialog"),a=t("../../../bundles/lobby/src/common/GlobalApp"),l=t("../../../bundles/lobby/src/common/ConfigClient"),{ccclass:h,property:c}=cc._decorator;let r=n=class extends o.default{constructor(){super(...arguments),this.ruleSprites=[],this.ruleContent=null,this.spriteIndex=0,this.isAnimating=!1}static getInstance(){return this.instance}actionNext(){this.ruleSprites.length<=0||this.isAnimating||(this.spriteIndex++,this.spriteIndex>=this.ruleSprites.length&&(this.spriteIndex=0),this.playPageTurnEffect(!0))}actionPrevious(){this.ruleSprites.length<=0||this.isAnimating||(this.spriteIndex--,this.spriteIndex<0&&(this.spriteIndex=this.ruleSprites.length-1),this.playPageTurnEffect(!1))}updateRuleDisplay(){this.ruleContent&&this.ruleSprites.length>0&&(this.ruleContent.spriteFrame=this.ruleSprites[this.spriteIndex])}playPageTurnEffect(t){if(!this.ruleContent||!this.ruleContent.node)return;this.isAnimating=!0;const i=this.ruleContent.node.scale,e=this.ruleContent.node.position,n=this.ruleContent.node.opacity;this.ruleContent.node.opacity=0,this.ruleContent.node.scale=.8*i,this.ruleContent.node.x=t?e.x+50:e.x-50,this.updateRuleDisplay(),cc.tween(this.ruleContent.node).to(.05,{opacity:100}).to(.25,{scale:i,x:e.x,opacity:n},{easing:"quartOut"}).call(()=>{this.isAnimating=!1}).start()}static show(t){null==this.instance||null==this.instance.node?a.default.getInstance().loadPrefabByBundle(l.default.Bundle.BUNDLE_NAME.TARZAN,"res/prefabs/TarzanRuleDialog",(i,e)=>{if(null!=i)return void a.default.getInstance().alertDialog.showMessage(i);let s=cc.instantiate(e);s.parent=t,this.instance=s.getComponent(n),this.instance.node.zIndex=1e3,this.instance.show()}):(this.instance.node.zIndex=1e3,this.instance.show())}show(){super.show(),this.spriteIndex=0,this.updateRuleDisplay()}};r.instance=null,s([c([cc.SpriteFrame])],r.prototype,"ruleSprites",void 0),s([c(cc.Sprite)],r.prototype,"ruleContent",void 0),r=n=s([h],r),e.default=r,cc._RF.pop()},{"../../../bundles/lobby/src/common/BaseDialog":void 0,"../../../bundles/lobby/src/common/ConfigClient":void 0,"../../../bundles/lobby/src/common/GlobalApp":void 0}]},{},["TarzanConstants","TarzanController","TarzanEnums","TarzanInterfaces","TarzanItem","TarzanItemAnimation","TarzanNetworkTransport","TarzanPresenter","TarzanRuleDialog"]);